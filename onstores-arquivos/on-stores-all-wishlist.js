/* dan - 23/06/2020 14:38:02 GMT-0300 */
var _headers={Accept:"application/vnd.vtex.ds.v10+json","Content-Type":"application/json"},_storeName=window.location.hostname.replace("www.","").replace(".com.br","").replace(".com","").replace(".vtexcommercestable","").replace(".myvtex","").replace("loja.",""),_product_id=null,_remove_product=null,wishlist={loading:{create:function(){$("body").append('<div id="e-wishlist-loader" style="background: url(https://econverse.digital/loader.gif) #0006 center no-repeat;position: fixed;width: 100%; height: 100%;z-index: 9999;background-size: 80px; top:0; left:0;"></div>')},remove:function(){$("#e-wishlist-loader").remove()}},methods:{start:function(){vtexjs.checkout.getOrderForm().done(function(_user_infos){if(0!=_user_infos.loggedIn){var _email=_user_infos.clientProfileData.email;wishlist.methods.userid(_email)}})},login:function(){vtexid.start({returnUrl:"",userEmail:"",locale:"pt-BR",forceReload:!1})},click:function(){$(".js--add--wishlist").click(function(event){var _element=$(this),_product_id=skuJson_0.productId;_element.hasClass("e-selected")?(_element.removeClass("e-selected"),_remove_product=!0,wishlist.methods.user(_product_id,_remove_product)):(_element.addClass("e-selected"),wishlist.methods.user(_product_id)),wishlist.loading.create()}),$("body").on("click",".x-product__image .js-add-wishlist",function(){var _element=$(this),_product_id=_element.closest(".x-product").find(".x-id").val();_element.hasClass("e-selected")?(_element.removeClass("e-selected"),_remove_product=!0,wishlist.methods.user(_product_id,_remove_product)):(_element.addClass("e-selected"),wishlist.methods.user(_product_id)),wishlist.loading.create()})},user:function(_product_id,_remove_product){vtexjs.checkout.getOrderForm().done(function(_user_infos){if(0==_user_infos.loggedIn)wishlist.methods.login();else{var _email=_user_infos.clientProfileData.email;wishlist.methods.userid(_email,_product_id,_remove_product)}})},userid:function(_email,_product_id,_remove_product){$.ajax({headers:_headers,type:"GET",url:"/api/dataentities/CL/search?_where=email="+_email+"&_fields=id",success:function(data){if($(data).length){var _user_id=data[0].id;wishlist.methods.get_products_ids(_user_id,_product_id,_remove_product)}else wishlist.methods.createUser(_email)}})},get_products_ids:function(_user_id,_product_id,_remove_product){$.ajax({headers:_headers,type:"GET",url:"/api/dataentities/CL/documents/"+_user_id+"?_fields=id,wishlist",success:function(_wishlist){if(""!=(_wishlist_products_ids=_wishlist.wishlist)&&null!=_wishlist_products_ids&&null!=_wishlist_products_ids)if(null!=_product_id)if(1==_remove_product){var _product_id_format=","+_product_id;_wishlist_products_ids=_wishlist_products_ids.replace(_product_id_format,"").replace(_product_id,""),wishlist.methods.create(_user_id,_wishlist_products_ids)}else _wishlist_products_ids=_wishlist_products_ids+","+_product_id,wishlist.methods.create(_user_id,_wishlist_products_ids);else wishlist.methods.success(_wishlist_products_ids);else if(null!=_product_id){if(1==_remove_product){_product_id_format=","+_product_id;_wishlist_products_ids=_product_id.replace(_product_id_format,"").replace(_product_id,"")}else var _wishlist_products_ids=_product_id;wishlist.methods.create(_user_id,_wishlist_products_ids)}}})},create:function(_user_id,_wishlist_products_ids){if(null!=_wishlist_products_ids&&null!=_wishlist_products_ids){var _json={wishlist:_wishlist_products_ids};$.ajax({headers:_headers,data:JSON.stringify(_json),type:"PATCH",url:"/api/dataentities/CL/documents/"+_user_id,success:function(_wishlist){wishlist.methods.success(_wishlist_products_ids)}})}},success:function(_wishlist_products_ids){wishlist.methods.seleteds(_wishlist_products_ids),wishlist.methods.page(_wishlist_products_ids),wishlist.loading.remove()},seleteds:function(_wishlist_products_ids){if(""!=_wishlist_products_ids&&null!=_wishlist_products_ids&&null!=_wishlist_products_ids){var _products=_wishlist_products_ids.split(",");if($("body").hasClass("produto"))for(var _button=$(".js--add--wishlist"),i=_products.length-1;0<=i;i--){_products[i]==skuJson_0.productId&&_button.addClass("x-selected")}$(".vitrine .x-product").each(function(index,el){for(var _element=$(this),_id=_element.find(".x-id").val(),i=_products.length-1;0<=i;i--){_products[i]==_id&&_element.find(".js-add-wishlist").addClass("e-selected")}}),$("body").hasClass("wishlist")&&setTimeout(function(){$(".vitrine .x-product").each(function(index,el){var _element=$(this);_element.find(".x-id").val();_element.find(".js-add-wishlist").addClass("e-selected")})},1e3)}},page:function(_wishlist_products_ids){if($("body").hasClass("wishlist"))if(""!=_wishlist_products_ids&&null!=_wishlist_products_ids){var _list_products=_wishlist_products_ids.split(/,/g).filter(function(id){return $.trim(id)}).map(function(id){return"fq=productId:"+id}).join("&"),_shelf_id="";switch(_storeName){case"shoppingcidadesp":_shelf_id="127335df-d9f5-41d8-9707-c234fcc67227";break;case"shoppingcerrado":_shelf_id="bddd2420-82f2-469a-b7ef-a1a19f2b1386";break;case"shoppingd":_shelf_id="f7c06ad6-d452-43c1-8581-403630d1e77c";break;case"shoppingmetropolitanobarra":_shelf_id="4e832636-cb6d-4089-af7f-89a2004b98a2";break;case"tieteplazashopping":_shelf_id="0e406324-932a-4b63-9d0f-f019c3ad11d3";break;case"grandplazashopping":_shelf_id="64cdbe46-47ec-4fcd-a527-373d54f15fd6"}$.ajax("/buscapagina?"+_list_products+"&PS=40&sl="+_shelf_id+"&cc=100&sm=0&PageNumber=1",{async:!1}).done(function(data){$("#x-get-products").html(data)}).fail(function(){console.log("Ocorreu um erro!")})}else $("#x-get-products").html("Você ainda não adicionou produtos em sua wishlist!")},createUser:function(_email){var _json={email:_email};$.ajax({headers:_headers,data:JSON.stringify(_json),type:"PATCH",url:"/api/dataentities/CL/documents/",success:function(data){wishlist.methods.userid(_email)}})},close_loading:function(){$("body").on("click",".vtexIdUI .modal-header .close",function(){wishlist.loading.remove()})},init:function(){this.start(),this.click(),this.seleteds(),this.page(),this.close_loading()},init_ajax:function(){}},ajax:function(){return this.methods.init_ajax()},mounted:function(){return this.methods.init()}};$(document).ready(function(){wishlist.mounted()}),$(document).ajaxStop(function(){wishlist.ajax()});