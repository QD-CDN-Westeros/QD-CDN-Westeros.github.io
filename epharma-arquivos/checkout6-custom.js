/* DESKTOP-TON - 21/05/2021 15:59:59 GMT */
/*!  */
var userData=!1,middleware="https://epharma.maeztra.com/epharma";function checkStorePartner(o){var e,t,n=(e="key",t=[],location.search.substring(1).split("&").forEach((function(o){t[o.split("=")[0]]=o.split("=")[1]})),null!=typeof t[e]&&t[e]);function r(){$.ajax({url:"https://epharma.maeztra.com/epharma/delete-token-info/3/"+encodeURIComponent(n),type:"DELETE",dataType:"json",success:function(o){try{console.log("Removido com sucesso.")}catch(o){console.log("Não foi possível deletar! ",o)}},error:function(o){console.log("Error: "+o.responseText)}})}n?function(e){$.ajax({url:"https://epharma.maeztra.com/epharma/get-token-info/3/"+encodeURIComponent(e)}).done((function(e){var t,n;e.success||Common.tokenError(),t=(n=JSON.parse(e.data.content)).partner.toLowerCase(),$("body").addClass(t),sessionStorage.setItem("cssinuse",t),sessionStorage.setItem("userData",JSON.stringify(n)),o(),r()}))}(n):null==sessionStorage.getItem("userData")?tokenError(userData):o()}function tokenError(){console.log("token error"),$("body").prepend('<div class="alert-error"><span>Acesso inválido</span></div>'),$("main").remove()}function saveOrderFormIdInSession(o){sessionStorage.setItem("of",JSON.stringify(o)),sessionStorage.setItem("of_autorizathion","0")}function confirmOrder(){var o=$("#cart-to-orderform"),e=$(".payment-confirmation-wrap button#payment-data-submit");o.on("click",(function(o){o.preventDefault(),e.css("pointer-events","none"),e.find(".icon-spinner").show(),e.find(".icon-lock").hide();var t=JSON.parse(vtexjs.checkout.orderForm.customData.customApps[0].fields.json),n={customData:t};$.ajax({url:middleware+"/post-authorization/",type:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify(n)}).done((function(o){if(console.log(o),o.success){var n=o.data.authorizationId,r=vtexjs.checkout.orderForm.orderFormId,a={authorizationId:n,customData:t};const s={async:!0,crossDomain:!0,url:middleware+"/put-custom-data/"+r,type:"PUT",headers:{"Content-Type":"application/json"},processData:!1,data:JSON.stringify({json:JSON.stringify(a)})};$.ajax(s).done((function(o){vtexjs.checkout.getOrderForm(),console.log("Autorizado: ",o),e.css("pointer-events","auto"),e.find(".icon-spinner").hide(),e.find(".icon-lock").show()}))}else console.log("Não autorizado!"),e.css("pointer-events","none"),alert("Compra não autorizada!")}))}))}$(document).ready((function(){checkStorePartner((function(){userData=!0})),vtexjs.checkout.getOrderForm().done((function(o){saveOrderFormIdInSession(o)})),"#/cart"===window.location.hash&&confirmOrder()})),$(window).on("hashchange",(function(){"#/cart"===window.location.hash&&confirmOrder()}));