$(function(){function v(b,a){b.addClass("qd-loading");$.qdAjax({url:"/produto/sku/"+a}).done(function(a){a=a[0].Images;for(var e,c=0;c<a.length;c++)"Personaliza"==a[c][0].name&&(e=a[c][0].Path);e||(e=a[0][0].Path);b.prepend('<img class="sku-image" src="'+e.replace(/(ids\/\d+)-\d+-\d+/,"$1-350-350")+'" />');b.removeClass("qd-loading")})}function w(b){b.find(".qd-fpp-items").addClass("qd-loading");vtexjs.checkout.simulateShipping([{id:h,quantity:1,seller:k}],"","BRA").done(function(a){var c=a.items,
e=null;for(a=0;a<c.length;a++)c[a].id==h&&(e=a);if(null!=e){for(var d,g=[],p,k,q,r,m,n=0;n<c[e].offerings.length;n++)for(d=c[e].offerings[n].attachmentOfferings,a=0;a<d.length;a++)d[a].schema&&d[a].schema["Autoriza abrir embalagem"]&&(m=d[a].schema["Autoriza abrir embalagem"],p=d[a].schema.Texto||null,text2=d[a].schema["Texto 2"]||null,k=d[a].schema.Letra?d[a].schema.Letra.domain:null,q=d[a].schema.Figura?d[a].schema.Figura.domain:null,r=d[a].schema["Cor da letra"]?d[a].schema["Cor da letra"].domain:
null,(p||text2||k||q||r)&&g.push({name:d[a].name,offering:c[e].offerings[n],fields:{authorizeOpenPackage:m,text:p,text2:text2,fonts:k,illustrations:q,colors:r}}));if(g.length){var f=g[0];a=c[e].sellingPrice+f.offering.price;b.find(".qd-fpp-price .total-price").text("R$ "+qd_number_format(a/100,2,",","."));null!=f.fields.authorizeOpenPackage&&b.find(".qd-authorize-remove-product").closest("fieldset").show();null!=f.fields.text&&b.find(".qd-baby-name").closest("fieldset").show();null!=f.fields.text2&&
b.find(".qd-baby-name-second").closest("fieldset").show();if(null!=f.fields.fonts){b.find(".qd-fpp-font").closest("fieldset").show();b.find(".qd-fpp-font").empty();for(a=0;a<f.fields.fonts.length;a++)c=$('<label style="font-family:'+f.fields.fonts[a]+';" class="radio-inline"><input type="radio" name="qd_font_radio" value="'+f.fields.fonts[a]+'">'+f.fields.fonts[a]+"</label>"),"Palace Script"!=f.fields.fonts[a]&&"Isabella Script"!=f.fields.fonts[a]||c.addClass("qd-fpp-big-font"),c.appendTo(".qd-fpp-font");
b.find(".qd-fpp-font .radio-inline").first().find("input").addClass("required")}if(null!=f.fields.illustrations){b.find(".qd-illustration").closest("fieldset").show();b.find(".qd-illustration").empty();b.find(".qd-illustration").append('<option value="">Sem ilustra\u00e7\u00e3o</option>');for(a=0;a<f.fields.illustrations.length;a++)c=f.fields.illustrations[a],b.find(".qd-illustration").append('<option value="'+c+'">'+c+"</option>"),t.append('<img src="/arquivos/qd-stamp-'+c.toLowerCase().replaceSpecialChars().replace(" ",
"-")+'.png" class="img-flag" />');b.find(".qd-illustration").select2({placeholder:"Sem ilustra\u00e7\u00e3o",minimumResultsForSearch:Infinity,templateResult:function(a){if(!a.id)return a.text;var b=a.text.toLowerCase().replaceSpecialChars().replace(" ","-");a=$('<span><img src="'+("/arquivos/qd-stamp-"+b+".png")+'" class="img-flag" /> '+a.text+"</span>");a.find(".img-flag").css("width","40px");return a}});b.find(".qd-illustration").val("Sem ilustra\u00e7\u00e3o").trigger("change.select2");b.find(".qd-illustration").closest(".input-group").addClass("filled")}if(null!=
f.fields.colors){b.find(".qd-fpp-colors").closest("fieldset").show();b.find(".qd-fpp-colors").empty();b.find(".qd-fpp-colors").append('<option value="">Sem cor</option>');for(a=0;a<f.fields.colors.length;a++)c=f.fields.colors[a],b.find(".qd-fpp-colors").append('<option value="'+c+'">'+c+"</option>"),t.append('<img src="/arquivos/personalizacao-cor-'+c.toLowerCase().replaceSpecialChars().replace(" ","-")+'.jpg" class="img-flag" />');b.find(".qd-fpp-colors").select2({placeholder:"Sem cor",templateResult:function(a){if(!a.id)return a.text;
var b="/arquivos/personalizacao-cor-"+a.text.toLowerCase().replaceSpecialChars().replace(" ","-")+".jpg";t.append('<img src="'+b+'" class="img-flag" />');a=$('<span><img src="'+b+'" class="img-flag" /> '+a.text+"</span>");a.find(".img-flag").css("width","40px");return a}})}b.find('.qd-fpp-items input[type="radio"]').on("click",function(){$(".input-group-radio .radio-inline").removeClass("checked");$(this).closest(".radio-inline").addClass("checked");l(null,null,$(this).val(),$(this).val().toLowerCase().replace(" ",
"-"))});b.find(".qd-fpp-items .qd-illustration").on("change",function(){$(this).val()?$(this).closest(".input-group").addClass("filled"):$(this).closest(".input-group").removeClass("filled");if(-1<vtxctx.categoryName.indexOf("Chupeta")&&$(".qd-baby-name-second").is(":hidden")){var a=$(this).val().toLowerCase().replace("\u00e2","a").replaceSpecialChars().replace(" ","-");"sem-ilustracao"==a?($(".qd-fpp-image #qd_fpp_nome").find("img").remove(),$(".qd-fpp-image #qd_fpp_nome").find(".qd-fpp-text").addClass("qd-fpp-no-img")):
l(null,"/arquivos/qd-stamp-"+a+".png",null)}});$(".qd_cart_auto").QD_buyButton({buyButton:b.find(".buy-button"),productPageCallback:function(){x(g,b,f)}});b.find(".modal-footer .buy-button").click(function(a){"#"==$(a.target).attr("href")&&(a.preventDefault(),y(g,b))})}else b.find(".qd-fpp-items").html('<p class="qd-error"> Servi\u00e7o de personaliza\u00e7\u00e3o de SKU n\u00e3o encontrado.</p>');b.find(".qd-fpp-items").removeClass("qd-loading")}})}function l(b,a,c,e){$(".qd-fpp-area #qd_fpp_nome").length||
$(".qd-fpp-area").append($('<div id="qd_fpp_nome">'));wrapperCustomize=$(".qd-fpp-area #qd_fpp_nome");a&&(wrapperCustomize.find("img").length?wrapperCustomize.find("img"):$("<img>").prependTo(wrapperCustomize)).attr("src",a);a=wrapperCustomize.find(".qd-fpp-text").length?wrapperCustomize.find(".qd-fpp-text"):$('<div class="qd-fpp-text"><span></span></div>').appendTo(wrapperCustomize);var d=$(".qd-fpp-show-font");b&&$(".qd-baby-name-second").is(":hidden")&&(d.find("span").html(b),d.find("p").hide(),
d.find("span").show(),-1<vtxctx.categoryName.indexOf("Chupeta")&&(a.find("span").html(b.replace(/\s/gi,"<br>"))," "!=b&&textFit(a,{minFontSize:16,maxFontSize:37})));c&&(a.find("span").css("font-family",c.replaceSpecialChars()),d.find("span").css("font-family",c.replaceSpecialChars()));if(e&&!(-1<vtxctx.categoryName.indexOf("Chupeta")||-1<vtxctx.categoryName.indexOf("Mamadeira")||-1<vtxctx.categoryName.indexOf("Copo"))){var g=$(".qd-fpp-preview-text");$('<img src="/arquivos/personalizacao-preview-'+
e+'.png" />').load(function(a){g.show()}).error(function(a){g.hide()}).appendTo(g.find("span").empty());g.hide()}wrapperCustomize.find("img").length?a.removeClass("qd-fpp-no-img"):a.addClass("qd-fpp-no-img");" "==d.find("span").text()&&(d.find("p").show(),d.find("span").hide())}function z(b,a,c){for(var e=null,d=vtexjs.checkout.orderForm.items,g=0;g<d.length;g++)d[g].id==b&&(e=g);null!=e&&vtexjs.checkout.addOffering(c.offering.id,e).done(function(b){vtexjs.checkout.addBundleItemAttachment(e,c.offering.id,
c.name,a).done(function(a){$(window).trigger("QuatroDigital.bia_callback")})})}function y(b,a){var c=$(".qd-fpp-items .form-qd-v1");c.validate({rules:{},submitHandler:function(b){$(b).valid()?(a.find(".modal-footer .buy-button").attr("href","/checkout/cart/add?sku="+h+"&qty=1&seller="+k+"&redirect=true&sc="+jssalesChannel),a.find(".modal-content").addClass("qd-loading")):a.find(".modal-footer .buy-button").attr("href","#");a.find(".modal-footer .buy-button").click()},highlight:function(a,b,c){a=$(a);
a.addClass(b).removeClass(c);a.is(":radio")?a.parents(".input-group-radio").addClass(b+"-wrapper").removeClass(c+"-wrapper"):a.parent().addClass(b+"-wrapper").removeClass(c+"-wrapper")},unhighlight:function(a,b,c){a=$(a);a.addClass(c).removeClass(b);a.is(":radio")?a.parents(".input-group-radio").addClass(c+"-wrapper").removeClass(b+"-wrapper"):a.parent().addClass(c+"-wrapper").removeClass(b+"-wrapper")},errorPlacement:function(){}});c.submit()}function x(b,a,c){$(window).one("orderFormUpdated.vtex",
function(){var b={};null!=c.fields.fonts&&(b.Letra=a.find(".qd-fpp-font .checked input").val()||"*** N\u00c3O ***");null!=c.fields.text&&(b.Texto=a.find(".qd-baby-name").val()||"*** N\u00c3O ***");null!=c.fields.text2&&(b["Texto 2"]=a.find(".qd-baby-name-second").val()||"*** N\u00c3O ***");null!=c.fields.illustrations&&(b.Figura=a.find(".qd-illustration").val()||"*** N\u00c3O ***");null!=c.fields.colors&&(b["Cor da letra"]=a.find(".qd-fpp-colors").val()||"*** N\u00c3O ***");null!=c.fields.authorizeOpenPackage&&
(b["Autoriza abrir embalagem"]=a.find(".qd-authorize-remove-product").is(":checked")?"true":"false");z(h,b,c);a.find(".modal-body").addClass("qd-loading")});$(window).one("QuatroDigital.bia_callback",function(){$(document.body).removeClass(".qd-ddc-product-add-time").removeClass(".qd-ddc-product-add-time-v2");a.modal("hide");var b=$(".qd-v1-modal").first().clone().addClass("qd-fpp-success");b.find(".modal-body").append('<a href="javascript: void(0);" class="qd-fpp-close" data-dismiss="modal">Fechar</a><i class="fa fa-check-circle" aria-hidden="true"></i><h5 class="qd-fpp-success-text">Produto adicionado com sucesso!</h5><div class="product-qd-v1-buy-button"><a class="qd-fpp-success-btn" href="/checkout">Finalizar Compra</a></div><a href="javascript: void(0);" class="qd-fpp-continue" data-dismiss="modal">Continuar comprando</a>');
b.find(".modal-header, .modal-footer").remove();b.modal()})}function m(b){b.preventDefault();h?(b=$(".qd-v1-modal").first().clone().addClass("qd-fpp-modal"),b.find(".modal-header").append("<link href='//cdn.quatrodigital.com/flickakids-arquivos/CSS.fli.taw.product-customization-fonts.css' rel='stylesheet' type='text/css'>"),b.find(".modal-header").append($("<h5></h5>").text($(".product-qd-v1-sku-selection-box .product-qd-v1-name").text())),b.find(".modal-header .close").addClass("qd-fpp-close").text("N\u00e3o quero personalizar o produto"),
b.find(".modal-body").append('<div class="row"><div class="col-xs-12 col-sm-5 qd-fpp-image"><div class="qd-fpp-area"></div></div><div class="col-xs-12 col-sm-7 qd-fpp-items"></div>'),v(b.find(".qd-fpp-image"),h),b.find(".qd-fpp-items").append('<div class="qd-fpp-show-font"><span></span><p>Para come\u00e7ar, digite um nome abaixo e selecione uma fonte.</p><p>(A visualiza\u00e7\u00e3o aparece aqui).</p></div><form class="form-qd-v1"><fieldset class="qd-fpp-fieldset-text"><label>Digite o nome</label><div class="input-group"><input type="text" class="qd-baby-name form-control required" placeholder="Escreva aqui o nome do beb\u00ea" maxlength="18"  name="qd_form_baby_name"></div><div class="qd-fpp-preview-text">Preview: <span></span></div></fieldset><fieldset class="qd-fpp-fieldset-text"><label>Digite o segundo nome</label><div class="input-group"><input type="text" class="qd-baby-name-second form-control required" placeholder="Escreva aqui o nome do beb\u00ea" maxlength="18"  name="qd_form_baby_name_second"></div><div class="qd-fpp-preview-text">Preview: <span></span></div></fieldset><fieldset><label>Escolha a ilustra\u00e7\u00e3o</label><div class="input-group"><select class="qd-illustration required" name="qd_form_illustration"></select></div></fieldset><fieldset><label>Escolha a fonte</label><div class="qd-fpp-font input-group-radio"></div></fieldset><fieldset><label>Escolha a cor</label><div class="input-group"><select class="qd-fpp-colors required"></select></div></fieldset><fieldset><label class="checkbox"><input class="qd-authorize-remove-product required" type="checkbox" name="qd-form-authorize-remove-product" value="autorizado"> Autorizo a Flicka Kids a retirar o produto da embalagem, para realizar a personaliza\u00e7\u00e3o por mim escolhida.</label></fieldset></form>'),
b.find(".modal-footer").append('<a href="javascript: void(0);" class="qd-fpp-close" data-dismiss="modal">N\u00e3o quero personalizar o produto</a><div class="qd-fpp-price">Valor com a personaliza\u00e7\u00e3o:<span class="total-price">R$ ---</span></div><div class="product-qd-v1-buy-button"><a class="buy-button qd-fpp-modal-btn" href="#">Comprar personalizado</a></div>'),b.insertAfter($(".qd-v1-modal").first()),b.on("hidden.bs.modal",function(a){$(this).remove()}),b.modal(),$(".qd-fpp-items select").on("change",
function(){$(this).val()?$(this).closest(".input-group").addClass("filled"):$(this).closest(".input-group").removeClass("filled");$(this).is(".qd-illustration")&&vtxctx.categoryName.indexOf("Chupeta")}),$('.qd-fpp-items input[type="radio"]').on("click",function(){$(".input-group-radio .radio-inline").removeClass("checked");$(this).closest(".radio-inline").addClass("checked");l(null,null,$(this).val().replaceSpecialChars())}),$('input[type="text"], button',".qd-fpp-items").on("click keyup",function(){var a=
$(this).closest("fieldset").find("input");a.val()?(a.closest(".input-group").addClass("filled"),a.is(".qd-baby-name")&&l(a.val())):(a.closest(".input-group").removeClass("filled"),a.is(".qd-baby-name")&&l(" "))}),w(b)):alert("Por favor, selecione o modelo desejado.")}if(!$(document.body).is(".product-kit")){"Personalizados"==vtxctx.departmentName&&$(document.body).addClass("qd-fpp-product-page");var u=$('<a href="#" class="qd-fpp-btn">Personalizar</a>').click(m);$(".product-qd-v1-sku-selection-box .product-qd-v1-buy-button").prepend(u);
$(".qd-fpp-banner").click(m);var t=$('<div class="qd-fpp-pre-load" style="width:1px;height:1px;overflow:hidden;opacity:0.01;"><br /></div>').insertAfter(u),h=null,k=null;if(1<skuJson.skus.length)$(window).on("skuSelected.vtex",function(b,a,c){h=c.sku;k=c.sellerId});else h=skuJson.skus[0].sku,k=skuJson.skus[0].sellerId}});