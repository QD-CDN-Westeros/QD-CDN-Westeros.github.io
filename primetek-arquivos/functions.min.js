!function(){var e="close";$(document).ready((function(){var o=$(".qd-v1-modal-newsletter");console.log("passou"),o.find(".qd-v1-modal-newsletter-step-1").show(),console.log("passou 1"),o.modal(),console.log("passou 2"),o.on("hidden.bs.modal",(function(){window.parent.postMessage("QdSn1Msg|"+e,"*"),console.log("passou 3")})),$(".qd-content-coupon").html((location.search.match(/code=([^&]+)/i)||[""]).pop()),console.log("passou 4")})),$((function(){var e=$("form"),o=e.find("[name=qd_email]");console.log("passou 5"),e.validate({rules:{email:{email:!0}},submitHandler:function(e){var n=$(e);if(n.valid()){var s=n.find("[name]");o=o.filter(s),n.addClass("qd-loading");var a=function(e){$.ajax({url:"//api.ipify.org?format=jsonp",dataType:"jsonp",success:function(e){a(e.ip)},error:function(){$.ajax({url:"//www.telize.com/jsonip",dataType:"jsonp",success:function(e){a(e.ip)},error:function(e){a(null)}})}});var s=n.serializeObject(),a=function(a){s.userId=e,s.ip=a,s.id=(o.val()||"").toLowerCase().replace(/[^a-z0-9]/gi,(function(e){return"-"+e.charCodeAt(0)+"-"})),$.ajax({url:"//mz-smart-newsletter-proxy.herokuapp.com/?jsnomeLoja=primetek&entity=NL",type:"PATCH",dataType:"json",headers:{Accept:"application/vnd.vtex.ds.v10+json","Content-Type":"application/json; charset=utf-8"},data:JSON.stringify(s),success:function(e){n.addClass("qd-form-success"),n.trigger("QD.crmSuccess",[e])},error:function(e){"0"==e.status||"304"==e.status?alert("Este e-mail já está cadastrado na newsletter!"):alert("Desculpe, não foi possível enviar seu formulário!")},complete:function(){n.removeClass("qd-loading")}})}};return $.ajax({url:"//mz-smart-newsletter-proxy.herokuapp.com/?jsnomeLoja=primetek&entity=CL&email="+(o.val()||"---"),type:"GET",dataType:"json",headers:{Accept:"application/vnd.vtex.ds.v10+json"},success:function(e){e.length?a(e[0].id):a(null)},error:function(){a(null)}}),!1}},errorPlacement:function(e,o){}}),console.log("passou 6")})),$(window).on("QD.crmSuccess",(function(o,n){$(".qd-v1-modal-newsletter");e="success",console.log("passou 7")}))}();