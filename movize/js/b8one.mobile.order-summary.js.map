{"version":3,"sources":["webpack:///./src/js/general/services/b8one.vtexCatalogService.js","webpack:///./src/js/general/utils/currency/index.js","webpack:///./src/js/general/components/b8one.modalComponent.js","webpack:///./src/js/general/utils/skusToIgnore/index.js","webpack:///./src/js/general/services/b8one.storageService.js","webpack:///./src/js/general/common/b8one.ensure.js","webpack:///./src/js/general/services/b8one.insuranceService.js","webpack:///./src/js/general/common/b8one.helper.js","webpack:///./src/js/general/common/b8one.logger.js","webpack:///./src/js/general/services/b8one.cartService.js","webpack:///./src/js/store/mobile/order-summary/index.js","webpack:///./src/js/general/services/b8one.httpClient.js"],"names":["VtexCatalogService","origin","this","api","axios","create","baseURL","categoryID","subcategoryID","_from","_to","orderBy","params","URLSearchParams","append","forEach","order","get","console","error","products","initial","end","getProductsByCategories","data","status","productId","REAL","value","currency","symbol","precision","separator","decimal","formatWithSymbol","ModalComponent","modal","modalShowCLass","openModalCallback","closeModalCallback","isOpen","openCallback","Function","closeCallback","Element","document","querySelector","classList","add","remove","StorageService","cartService","CartService","vtexCatalogService","getCurrent","items","Promise","all","filter","product","SKUS_TO_IGNORE","includes","parseInt","id","map","quantity","getProductVariations","skuSelected","skus","sku","weight","measures","total","productsWeightArray","totalWeight","Math","round","reduce","storageQuantity","storageSKUID","index","findIndex","userSelectedStorageMonths","customData","orderInfo","customApps","customApp","storageProduct","totalSKUsInOrderForm","length","getTotalStorageQuantity","user_need_storage","fields","isQuantityDifferent","updateProduct","toLowerCase","addSKUStorageToOrderForm","removeSKUStorageInOrderForm","Ensure","undefined","input","isUndefined","checkValidity","object","props","getMissingProps","missingProps","prop","push","InsuranceService","price","skuIndex","orderFormId","endpoint","fetch","method","body","JSON","stringify","headers","Accept","json","Helper","_logger","Logger","language","navigator","userLanguage","currencyLocale","minimumFractionDigits","elem","selector","prototype","matches","matchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","s","ownerDocument","querySelectorAll","i","item","parents","parentNode","form","serialized","elements","field","name","disabled","type","n","options","selected","encodeURIComponent","checked","join","random","toString","substr","cname","cvalue","exdays","date","Date","setTime","getTime","expires","toUTCString","cookie","decodeURIComponent","split","element","heightViewport","window","innerHeight","documentElement","clientHeight","widthViewport","innerWidth","clientWidth","getBoundingClientRect","top","right","bottom","left","str","mapAccents","a","e","o","u","c","pattern","replace","RegExp","toFixed","max","Intl","NumberFormat","style","format","logName","message","errorObj","info","warn","log","_VTEX_API_ENDPOINT","_httpClient","HttpClient","skuId","productQuantity","sellerId","current","indexFound","x","endpointUrl","payload","orderItems","seller","patch","vtexjs","checkout","getOrderForm","skusCustomProducts","getCustomProducts","isCustom","skuToIgnore","indexToRemove","indexList","removeMoreProducts","response","productsToAdd","productsToUpdate","sameSku","diffQuantity","productsToReplaceSKU","itemsList","oldSKU","newSKU","productsToRemove","updateItems","replaceSKU","removeItems","addToCart","customProducts","newQuantity","customProductItem","currentCustomProduct","customProductQuantity","Object","values","itemIndex","expectedOrderFormSections","noSplitItem","itemsIndex","updateProducts","postalCode","country","calculateShipping","orderForm","simulateShipping","orderFormSimulated","logisticsInfo","shippingData","sendAttachment","address","availableAddresses","selectedAddresses","appName","put","appFieldName","appFieldValue","delete","OrderSummaryPage","addressCep","modalRemoveProductInstance","dateSelected","modalDate","calendarInstance","insuranceItems","httpClient","storageService","insuranceService","helper","userIsDefined","transporterSelected","totalInsuranceFormatted","totalInsurance","totalOrderSummary","totalTransporterSelected","totalStorageMonth","totalStorage","totalizers","customSelectStorageServiceInstance","liftingQuantity","lifting","tableContentElement","init","$","user","IsUserDefined","initModalRemoveProduct","initModalDate","initTermsModal","setHandledTermsCheckboxChange","handleGoToPaymentButton","setHandledButtonEditDateClick","setHandledButtonSaveClick","updateOrderForm","updateShippingData","setTransporterSelected","setTotalInsurance","getProductsInCustomData","setDate","getAddress","getInsuranceItems","setAddressCep","getLiftingFromCustomData","addServicesToDOM","updateSelectedSLA","initCalendar","setTotalTransporterSelected","setTotalOrderSummary","setTotalOrderSummaryElement","transporterHTML","createTransporterElement","orderFormProductsHTML","createProductstInOrderForm","customProductsHTML","createCustomProducts","addTransporterToDOM","addOrderFormProductsToDOM","addCustomProductsToDOM","addEventListener","preventDefault","shippingDateContainer","header","scrollTo","offsetTop","offsetHeight","setHandledProducts","setHandledTransporterElement","setHandledUpdateButtonClick","removePageLoading","flatpickr","inline","dateFormat","minDate","fp_incr","defaultDate","locale","Portuguese","appendTo","prevArrow","nextArrow","disable","getDay","btnContinue","btnClose","modalTerms","saveData","updateInsuranceValue","updateTranspoterValue","location","assign","loginUser","close","clientProfileData","customAppOrderInfo","addressType","city","to_city","neighborhood","to_address_county","number","to_address_number","to_address_zipcode","state","to_state","street","to_address_name","receiverName","firstName","lastName","email","shippingTotalizer","orderInfoApp","updateCheckoutAddress","updateCheckoutTransporterSLA","search","indexOf","clearMessages","vtexid","start","returnUrl","href","forceReload","show","buttonContinue","removeAttribute","setAttribute","priceFormatted","deliveryTypeSelected","textContent","multiply","modalRemoveProduct","modalRemoveProductButtonClose","buttonRemoveProduct","buttonCancelRemove","keys","hideErrorRemoveProductMessage","productIdToRemove","target","dataset","handledConfirmRemoveProduct","showErrorRemoveProductMessage","button","modalDateButtonClose","buttonCancel","formattedDate","formatDate","selectedDates","updateCalendarComponent","transporter","priceElement","event","prevPriceElementActive","transporterDeliveryType","buttonMinusQuantity","buttonAddQuantity","inputCheckbox","buttonRemove","inputProductQuantity","inputProductActive","handledMinusQuantityProduct","handledAddQuantityProduct","handledSpecialPackagingProduct","handledRemoveProductClick","handledProductQuantityChange","handledProductActiveChange","setHandledProduct","transporterElement","transporterDeliveryTypeSelected","deliveryTypes","courier_data","parse","orderDeliveryTypesByLessPrice","productQuantityElement","requiresLifting","liftingQuantityOrigin","liftingQuantityDestination","skuIdWithBox","skuIdWithoutBox","productSpecialPackaging","currentProduct","specialPackaging","active","productName","imgURL","description","productHTML","createElement","innerHTML","productData","productElement","productIndex","updateTotalOrderValue","parentElement","productNameElement","productImageElement","modalProductContainer","oldProduct","createCustomProductForModalRemove","createProductForModalRemove","src","prepend","newInsuranceValue","insuranceItem","setTotalizers","insuranceSKU","totalItemsWithDiscounts","totalizer","activeProductsWithoutCustoms","activeProductsCustoms","customProduct","storageSKU","liftingSKUS","activeProducts","logisticInfo","ids","courierIds","slas","sla","deliveryIds","courierId","getDeliveryTypes","deliveryType","newPrice","slaName","manualPrice","newPriceFormatted","formatPrice","updateTransporterElement","transporterVariations","key","getTransporterVariations","courierType","courier","imageUrl","customAttributes","skuName","createProduct","createCustomProduct","products_data","isSelected","transporterData","nome","logoURL","features","descricao","prices","createTransporterPriceElement","deliveryShared","deliveryExclusive","moving_date","movingData","cardNumber","dateInstance","dayjs","day","mounth","year","dateFormatted","nextElementSibling","addresses","entries","obj","container","addressDirection","contains","cardContent","selectSpecialHandlyConditionSelected","selectHomeTypeSelected","specialHandlyCondition","complement","county","streetName","zipcode","homeType","firstParagraphContent","secondParagraphContent","thirdParagraphContent","makeCRUD","removeAllItems","productsWithQuantity","additionalWeightSKUs","getAdditionalWeightSKU","disassemblyAndAssemblySKUs","getDisassemblyAndAssemblySKU","liftingSKUs","getLiftingSKUs","getInsuranceSKU","getInsuranceDataInCustomData","totalInsurancePrice","checkoutCRUD","insuranceSkuIndex","getInsuranceSkuIndex","updateInsuranceSKUPrice","intValue","liftingTotalPrice","calculateLiftingTotalPrice","totalForSpecialPackaging","calculateTotalForSpecialPackaging","totalDisassemblyAndAssemblyPrice","calculateTotalForDisassemblyAndAssembly","updateServiceItem","orderInfoFieldsForCustomData","current_step","user_selected_storage_months","lifting_total_price","special_packaging_total_price","insuranceItemsForCustomData","insuranceFieldsForCustomData","setMultipleCustomDataFields","setSingleCustomDataField","buttonUpdate","buttonUpdateTextElement","hideUpdateErrorMessage","handledUpdateButtonClick","showUpdateErrorMessage","innerText","setTimeout","dispatchEvent","initSaveCustomDataEvent","endSaveCustomDataEvent","sort","b","liftingQuantityToSubtract","liftingPrice","totalLiftingPrice","liftingItems","getLiftingItems","newTotal","storageItem","getStorageItem","totalStoragePrice","divide","itemsWithSpecialPackaging","getItemsWithSpecialPackaging","totalSpecialPackagingPrice","disassemblyAndAssemblySKU","find","serviceName","serviceValue","serviceID","serviceItem","calculateStoragePrice","serviceStorageHTML","createServiceItem","serviceLiftingHTML","serviceSpecialPackagingHTML","serviceDisassemblyAndAssemblyHTML","serviceItemsTable","createCustomSelectForStorageService","updateCustomSelectStorageService","selectElement","selectCustom","customSelectList","customSelectSelected","CustomSelect","customSelectListItemClassName","customSelectListItemClassNameActive","selectOpenCallback","selectListHeight","maxHeight","selectCloseCallback","selectChangeCallback","changeOption","selectedSla","getLiftingQuantity","additionalWeight","requiresAssembly","requiresDisassembly","insuranceApp","_execute","httpVerb","accept","then","validateResponse","parseResponseToJson","catch","ok","resolve","reject","Error","statusText"],"mappings":"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","file":"js/b8one.mobile.order-summary.js","sourcesContent":["import axios from 'axios';\r\n\r\nexport default class VtexCatalogService {\r\n  /**\r\n   * @param  {String} origin='' Origin example => https://www.example.com\r\n   */\r\n  constructor(origin = '') {\r\n    this.api = axios.create({\r\n      baseURL: `${origin}/api/catalog_system`,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * This function is a abstraction of VTEX Search API for get and return products by categoryID (Parent) and subcategoryID (child)\r\n   * and return an array of products, also you can order the products with orderBy param, fetch max 50 products per request.\r\n   *\r\n   * For more information go to the follow link:\r\n   * https://documenter.getpostman.com/view/845/vtex-search-api/Hs43?version=latest#e0ec3923-faf7-5049-8634-f6d617ce5f67\r\n   *\r\n   * @param  {String|Number} categoryID\r\n   * @param  {String|Number} subcategoryID\r\n   * @param  {String|Number} _from=0\r\n   * @param  {String|Number} _to=49\r\n   * @param  {Array} orderBy=['OrderByNameASC']\r\n   * @return {Array} Array of products.\r\n   */\r\n  async getProductsByCategories(\r\n    categoryID,\r\n    subcategoryID,\r\n    _from = 0,\r\n    _to = 49,\r\n    orderBy = ['OrderByNameASC']\r\n  ) {\r\n    try {\r\n      const params = new URLSearchParams();\r\n\r\n      params.append('_to', _to);\r\n      params.append('_from', _from);\r\n      params.append('fq', `C:/${categoryID}/${subcategoryID}`);\r\n\r\n      orderBy.forEach(order => params.append('O', order));\r\n\r\n      return await this.api.get('/pub/products/search', { params });\r\n    } catch (error) {\r\n      console.error(\r\n        'Error in VtexCatalogService on method getProductsByCategories',\r\n        error\r\n      );\r\n    }\r\n\r\n    return;\r\n  }\r\n\r\n  /**\r\n   * This function get and return all products by categoryID (Parent) and subcategoryID (child)\r\n   * and return an array of products.\r\n   * @param  {String|Number} categoryID\r\n   * @param  {String|Number} subcategoryID\r\n   * @return {Array} Array of products.\r\n   */\r\n  async getAllProductsByCategories(categoryID, subcategoryID) {\r\n    try {\r\n      let products = [];\r\n      let initial = 0;\r\n      let end = 49;\r\n\r\n      while (true) {\r\n        const { data, status } = await this.getProductsByCategories(\r\n          categoryID,\r\n          subcategoryID,\r\n          initial,\r\n          end\r\n        );\r\n\r\n        initial = end + 1;\r\n        end = end * 2 + 1;\r\n\r\n        products = [...products, ...data];\r\n\r\n        if (status === 200) {\r\n          break;\r\n        }\r\n      }\r\n\r\n      return products;\r\n    } catch (error) {\r\n      console.error(\r\n        'Error in VtexCatalogService on method getAllProductsByCategories',\r\n        error\r\n      );\r\n    }\r\n\r\n    return;\r\n  }\r\n\r\n  /**\r\n   * This function get and return all categories of the category tree.\r\n   * @return {Array} Array of categories.\r\n   */\r\n  async getAllCategories() {\r\n    try {\r\n      return await this.api.get('/pub/category/tree/1');\r\n    } catch (error) {\r\n      console.error(\r\n        'Error in VtexCatalogService on method getAllCategories',\r\n        error\r\n      );\r\n    }\r\n\r\n    return;\r\n  }\r\n\r\n  /**\r\n   * @param  {String|Number} productId The id of the product\r\n   * @return {Object} Product Object with SKUS Variations.\r\n   */\r\n  async getProductVariations(productId) {\r\n    try {\r\n      return await this.api.get(`/pub/products/variations/${productId}`);\r\n    } catch (error) {\r\n      console.error(\r\n        'Error in VtexCatalogService on method getProductVariations',\r\n        error\r\n      );\r\n    }\r\n\r\n    return;\r\n  }\r\n}\r\n","import currency from 'currency.js';\r\n\r\nconst REAL = value =>\r\n  currency(value, {\r\n    symbol: 'R$ ',\r\n    precision: 2,\r\n    separator: '.',\r\n    decimal: ',',\r\n    formatWithSymbol: true,\r\n  });\r\n\r\nexport { REAL };\r\n","/*\r\n  *\r\n  * Author: Enrique Mora <enriquebeta7@gmail.com>\r\n  *\r\n*/\r\n\r\nexport default class ModalComponent {\r\n\t/**\r\n\t * @param  { Element | String } modal\r\n\t * @param  { String } modalShowCLass\r\n\t * @param  { Function } openModalCallback\r\n\t * @param  { Function } closeModalCallback\r\n   * @requires modal\r\n\t */\r\n\tconstructor({\r\n\t\tmodal,\r\n\t\tmodalShowCLass,\r\n\t\topenModalCallback,\r\n\t\tcloseModalCallback,\r\n\t}) {\r\n\t\tthis.isOpen = false;\r\n\t\tthis.modalShowCLass = modalShowCLass || 'show';\r\n\t\tthis.openCallback = openModalCallback || new Function();\r\n\t\tthis.closeCallback = closeModalCallback || new Function();\r\n\t\tthis.modal =\r\n\t\t\tmodal instanceof Element ? modal : document.querySelector(modal);\r\n\t}\r\n\r\n\tshow() {\r\n\t\t!this.isOpen && this.modal.classList.add(this.modalShowCLass);\r\n\t\tthis.isOpen = true;\r\n\r\n\t\tthis.openCallback(this);\r\n\t}\r\n\r\n\tclose() {\r\n\t\tthis.isOpen && this.modal.classList.remove(this.modalShowCLass);\r\n\t\tthis.isOpen = false;\r\n\r\n\t\tthis.closeCallback(this);\r\n\t}\r\n}\r\n","/**\r\n ** SKU IDs to ignore.\r\n *? IDs 19 and 698 are lifting products.\r\n *? IDs 25 and 26 are custom products.\r\n *? ID 33 is storage product.\r\n *? ID 35 is insurance sku.\r\n *? ID 696 is additional weight sku.\r\n *? ID 699 is disassembly and assembly sku.\r\n */\r\nexport default [19, 698, 25, 26, 33, 35, 696, 699];\r\n","// Services\r\nimport CartService from 'Services/b8one.cartService.js';\r\nimport VtexCatalogService from 'Services/b8one.vtexCatalogService.js';\r\n\r\n// Utils\r\nimport SKUS_TO_IGNORE from 'Utils/skusToIgnore';\r\n\r\nexport default class StorageService {\r\n  constructor() {\r\n    this.cartService = new CartService();\r\n    this.vtexCatalogService = new VtexCatalogService();\r\n  }\r\n\r\n  async getTotalStorageQuantity() {\r\n    const { items } = await this.cartService.getCurrent();\r\n\r\n    const productsWeightArray = await Promise.all(\r\n      items\r\n        .filter(product => !SKUS_TO_IGNORE.includes(parseInt(product.id)))\r\n        .map(async ({ productId, id, quantity }) => {\r\n          const { data } = await this.vtexCatalogService.getProductVariations(\r\n            productId\r\n          );\r\n\r\n          const skuSelected = data.skus.filter(\r\n            ({ sku }) => parseInt(sku) === parseInt(id)\r\n          )[0];\r\n\r\n          if (skuSelected) {\r\n            const { weight } = skuSelected.measures;\r\n            const total = weight * quantity;\r\n\r\n            return total;\r\n          }\r\n\r\n          return 0;\r\n        })\r\n    );\r\n\r\n    const totalWeight = Math.round(\r\n      productsWeightArray.reduce((total, weight) => total + weight, 0)\r\n    );\r\n\r\n    let storageQuantity = Math.round(totalWeight / 5);\r\n\r\n    storageQuantity = storageQuantity > 0 ? storageQuantity : 1;\r\n\r\n    return storageQuantity;\r\n  }\r\n\r\n  async addSKUStorageToOrderForm(storageSKUID, quantity) {\r\n    return await this.cartService.add(storageSKUID, quantity);\r\n  }\r\n\r\n  async removeSKUStorageInOrderForm(storageSKUID, products) {\r\n    const index = products.findIndex(\r\n      product => parseInt(product.id) === storageSKUID\r\n    );\r\n\r\n    if (index !== -1) {\r\n      return await this.cartService.remove(index);\r\n    }\r\n  }\r\n\r\n  async dispatchActionWorksWithStorageSKU(userSelectedStorageMonths = 1) {\r\n    const storageSKUID = 33;\r\n\r\n    const { customData, items } = await this.cartService.getCurrent();\r\n\r\n    if (!customData) return;\r\n\r\n    const orderInfo = customData.customApps.filter(\r\n      customApp => customApp.id === 'orderinfo'\r\n    )[0];\r\n\r\n    const storageProduct = items.filter(product => {\r\n      return parseInt(product.id) === storageSKUID;\r\n    })[0];\r\n\r\n    const totalSKUsInOrderForm = items.filter(\r\n      product => !SKUS_TO_IGNORE.includes(parseInt(product.id))\r\n    ).length;\r\n\r\n    if (!orderInfo) return;\r\n\r\n    let quantity = await this.getTotalStorageQuantity();\r\n\r\n    quantity *= userSelectedStorageMonths;\r\n\r\n    const { user_need_storage } = orderInfo.fields;\r\n\r\n    let isQuantityDifferent;\r\n\r\n    if (storageProduct) {\r\n      isQuantityDifferent = storageProduct.quantity !== quantity;\r\n    }\r\n\r\n    if (isQuantityDifferent && totalSKUsInOrderForm > 0) {\r\n      return await this.cartService.updateProduct(storageSKUID, quantity);\r\n    } else if (\r\n      user_need_storage.toLowerCase() === 'true' &&\r\n      totalSKUsInOrderForm > 0\r\n    ) {\r\n      return await this.addSKUStorageToOrderForm(storageSKUID, quantity);\r\n    } else {\r\n      return await this.removeSKUStorageInOrderForm(storageSKUID, items);\r\n    }\r\n  }\r\n}\r\n","/**\r\n * Ensure Abstraction class\r\n */\r\nclass Ensure {\r\n  /**\r\n   * Ensure value is Undefined\r\n   * @param {*} value Value to be validated\r\n   * @return {boolean}\r\n   */\r\n  static isUndefined(value = undefined) {\r\n    return typeof value === 'undefined' ||\r\n      value === null ||\r\n      value === '' ||\r\n      value === {} ||\r\n      value === [];\r\n    // || JSON.stringify(value) === JSON.stringify({});\r\n  }\r\n\r\n  /**\r\n   * Ensure Input validity\r\n   * @param {*} input to validate\r\n   * @return {boolean} true if is valid\r\n   */\r\n  static isInputValid(input) {\r\n    return !this.isUndefined(input) && input.checkValidity();\r\n  }\r\n\r\n  /**\r\n   * Verify if object has properties\r\n   * @param {Object} object - Object to be verified\r\n   * @param {Array} props - properties to search on object\r\n   * @return {Boolean} True if object has all properties\r\n   */\r\n  static hasProps(object, props) {\r\n    const missingPropsResult = this.getMissingProps(object, props);\r\n    return missingPropsResult.length <= 0;\r\n  }\r\n\r\n  /**\r\n   * Get Object missing properties\r\n   * @param {Object} object - Object to be verified\r\n   * @param {Array} props - properties to search on object\r\n   * @return {Array} missing properties\r\n   */\r\n  static getMissingProps(object, props) {\r\n    let missingProps = [];\r\n    [...props].forEach((prop) => {\r\n      const result = prop in object;\r\n      if (!result) {\r\n        missingProps.push(prop);\r\n      }\r\n    });\r\n\r\n    return missingProps;\r\n  }\r\n}\r\n\r\nexport default Ensure;\r\n","export default class InsuranceService {\r\n  constructor() {}\r\n\r\n  async updateInsuranceSKUPrice(price, skuIndex, orderFormId) {\r\n    if (skuIndex === -1 || !price) return;\r\n\r\n    const endpoint = `https://wcdlfckgi9.execute-api.us-east-2.amazonaws.com/v1/api/checkout/pub/orderform/${orderFormId}/items/${skuIndex}/price`;\r\n\r\n    return await (\r\n      await fetch(endpoint, {\r\n        method: 'PUT',\r\n        body: JSON.stringify({\r\n          price,\r\n        }),\r\n        headers: {\r\n          Accept: 'application/json',\r\n          'Content-Type': 'application/json',\r\n        },\r\n      })\r\n    ).json();\r\n  }\r\n}\r\n","/* eslint-disable max-len */\r\nimport { Logger } from './';\r\n\r\n/**\r\n * Helper Abstraction class\r\n */\r\nclass Helper {\r\n  /**\r\n   * Helper constructor\r\n   * @param {*} props\r\n   */\r\n  constructor(props) {\r\n    this._logger = new Logger('Ensure');\r\n    this.props = props || {\r\n      language: navigator.language || navigator.userLanguage,\r\n      currency: 'BRL',\r\n      currencyLocale: 'pt-br',\r\n      minimumFractionDigits: 2,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * format currency\r\n   * @param {*} value\r\n   * @param {*} minimumFractionDigits\r\n   * @return {*}\r\n   */\r\n  formatPrice(value) {\r\n    value = value / 100;\r\n    value = (value * 1).toFixed(\r\n      Math.max(0, ~~this.props.minimumFractionDigits)\r\n    );\r\n\r\n    return new Intl.NumberFormat(this.props.currencyLocale, {\r\n      style: 'currency',\r\n      currency: this.props.currency,\r\n      minimumFractionDigits: this.props.minimumFractionDigits,\r\n    }).format(value);\r\n  }\r\n\r\n  static getParents(elem, selector) {\r\n    // Element.matches() polyfill\r\n    if (!Element.prototype.matches) {\r\n      Element.prototype.matches =\r\n        Element.prototype.matchesSelector ||\r\n        Element.prototype.mozMatchesSelector ||\r\n        Element.prototype.msMatchesSelector ||\r\n        Element.prototype.oMatchesSelector ||\r\n        Element.prototype.webkitMatchesSelector ||\r\n        function(s) {\r\n          let matches = (this.document || this.ownerDocument).querySelectorAll(\r\n              s\r\n            ),\r\n            i = matches.length;\r\n\r\n          while (--i >= 0 && matches.item(i) !== this) {}\r\n\r\n          return i > -1;\r\n        };\r\n    }\r\n\r\n    // Set up a parent array\r\n    let parents = [];\r\n\r\n    // Push each parent element to the array\r\n    for (; elem && elem !== document; elem = elem.parentNode) {\r\n      if (selector) {\r\n        if (elem.matches(selector)) {\r\n          parents.push(elem);\r\n        }\r\n\r\n        continue;\r\n      }\r\n\r\n      parents.push(elem);\r\n    }\r\n\r\n    // Return our parent array\r\n    return parents;\r\n  }\r\n\r\n  static serializeForm(form) {\r\n    // Setup our serialized data\r\n    let serialized = [];\r\n\r\n    // Loop through each field in the form\r\n    for (let i = 0; i < form.elements.length; i++) {\r\n      let field = form.elements[i];\r\n\r\n      // Don't serialize fields without a name, submits, buttons, file and reset inputs, and disabled fields\r\n      if (\r\n        !field.name ||\r\n        field.disabled ||\r\n        field.type === 'file' ||\r\n        field.type === 'reset' ||\r\n        field.type === 'submit' ||\r\n        field.type === 'button'\r\n      )\r\n        continue;\r\n\r\n      // If a multi-select, get all selections\r\n      if (field.type === 'select-multiple') {\r\n        for (let n = 0; n < field.options.length; n++) {\r\n          if (!field.options[n].selected) continue;\r\n\r\n          serialized.push(\r\n            encodeURIComponent(field.name) +\r\n              '=' +\r\n              encodeURIComponent(field.options[n].value)\r\n          );\r\n        }\r\n      }\r\n\r\n      // Convert field data to a query string\r\n      else if (\r\n        (field.type !== 'checkbox' && field.type !== 'radio') ||\r\n        field.checked\r\n      ) {\r\n        serialized.push(\r\n          encodeURIComponent(field.name) + '=' + encodeURIComponent(field.value)\r\n        );\r\n      }\r\n    }\r\n\r\n    return serialized.join('&');\r\n  }\r\n\r\n  static getFormData(form) {\r\n    // Setup our serialized data\r\n    let data = {};\r\n\r\n    // Loop through each field in the form\r\n    for (let i = 0; i < form.elements.length; i++) {\r\n      let field = form.elements[i];\r\n\r\n      // Don't serialize fields without a name, submits, buttons, file and reset inputs, and disabled fields\r\n      if (\r\n        !field.name ||\r\n        field.disabled ||\r\n        field.type === 'file' ||\r\n        field.type === 'reset' ||\r\n        field.type === 'submit' ||\r\n        field.type === 'button'\r\n      )\r\n        continue;\r\n\r\n      // If a multi-select, get all selections\r\n      if (field.type === 'select-multiple') {\r\n        for (let n = 0; n < field.options.length; n++) {\r\n          if (!field.options[n].selected) continue;\r\n\r\n          data[field.name] = field.options[n].value;\r\n        }\r\n      }\r\n\r\n      // Convert field data to a query string\r\n      else if (\r\n        (field.type !== 'checkbox' && field.type !== 'radio') ||\r\n        field.checked\r\n      ) {\r\n        data[field.name] = field.value;\r\n      }\r\n    }\r\n\r\n    return data;\r\n  }\r\n\r\n  static getRandomID() {\r\n    // Generate unique IDs for use as pseudo-private/protected names.\r\n    // Similar in concept to\r\n    // <http://wiki.ecmascript.org/doku.php?id=strawman:names>.\r\n    //\r\n    // The goals of this function are twofold:\r\n    //\r\n    // * Provide a way to generate a string guaranteed to be unique when compared\r\n    //   to other strings generated by this function.\r\n    // * Make the string complex enough that it is highly unlikely to be\r\n    //   accidentally duplicated by hand (this is key if you're using `ID`\r\n    //   as a private/protected name on an object).\r\n    //\r\n    // Use:\r\n    //\r\n    //     var privateName = ID();\r\n    //     var o = { 'public': 'foo' };\r\n    //     o[privateName] = 'bar';\r\n\r\n    // Math.random should be unique because of its seeding algorithm.\r\n    // Convert it to base 36 (numbers + letters), and grab the first 9 characters\r\n    // after the decimal.\r\n\r\n    return (\r\n      '_' +\r\n      Math.random()\r\n        .toString(36)\r\n        .substr(2, 9)\r\n    );\r\n  }\r\n\r\n  static setCookie(cname, cvalue, exdays) {\r\n    const date = new Date();\r\n\r\n    date.setTime(date.getTime() + exdays * 24 * 60 * 60 * 1000);\r\n\r\n    const expires = 'expires=' + date.toUTCString();\r\n\r\n    document.cookie = `${cname}=${cvalue};${expires};path=/`;\r\n  }\r\n\r\n  static getCookie(cname) {\r\n    const decodedCookie = decodeURIComponent(document.cookie);\r\n\r\n    const cookie = decodedCookie\r\n      .split(';')\r\n      .filter(cookie => cookie.includes(cname))[0];\r\n\r\n    return cookie || '';\r\n  }\r\n\r\n  static isInViewport(element) {\r\n    const heightViewport =\r\n      window.innerHeight || document.documentElement.clientHeight;\r\n\r\n    const widthViewport =\r\n      window.innerWidth || document.documentElement.clientWidth;\r\n\r\n    const { top, right, bottom, left } = element.getBoundingClientRect();\r\n\r\n    return (\r\n      top >= 0 &&\r\n      left >= 0 &&\r\n      bottom <= heightViewport &&\r\n      right <= widthViewport\r\n    );\r\n  }\r\n\r\n  static removeAccents(str) {\r\n    const mapAccents = {\r\n      a: '|||||||',\r\n      e: '|||||',\r\n      i: '|||||',\r\n      o: '|||||||',\r\n      u: '|||||||',\r\n      c: '|',\r\n      n: '|',\r\n    };\r\n\r\n    for (let pattern in mapAccents) {\r\n      str = str.replace(new RegExp(mapAccents[pattern], 'g'), pattern);\r\n    }\r\n\r\n    return str;\r\n  }\r\n}\r\n\r\nexport default Helper;\r\n","/* eslint no-console: 0 */\r\n\r\n/**\r\n * Logger Abstraction class\r\n */\r\nclass Logger {\r\n  /**\r\n   * Logger constructor\r\n   * @param {string} logName Application name to log\r\n   */\r\n  constructor(logName = 'B8ONE Logger Component') {\r\n    this.logName = logName;\r\n  }\r\n\r\n  /**\r\n   * Log error message\r\n   * @param {*} message - Message text\r\n   * @param {*} errorObj - Message object\r\n   */\r\n  error(message = '', errorObj = {}) {\r\n    console.error(message, errorObj);\r\n  }\r\n\r\n  /**\r\n   * Log information message\r\n   * @param {*} message - Message text\r\n   */\r\n  info(message = '') {\r\n    console.info(message);\r\n  }\r\n\r\n  /**\r\n   * Log warning message\r\n   * @param {*} message - Message text\r\n   */\r\n  warning(message = '') {\r\n    console.warn(this.logName, message);\r\n  }\r\n\r\n  /**\r\n   * Generic log\r\n   * @param {String} message - log's message\r\n   */\r\n  log(message = '') {\r\n    console.log(message);\r\n  }\r\n\r\n  /**\r\n   * Generic log\r\n   * @param {String} message - log's message\r\n   * @param {*} object - object to be logged\r\n   */\r\n  log(message = '', object = {}) {\r\n    console.log(message, object);\r\n  }\r\n}\r\n\r\nexport default Logger;\r\n","/* eslint-disable max-len */\r\n\r\nimport { Ensure, Logger } from '../common';\r\nimport HttpClient from './b8one.httpClient';\r\n\r\n/**\r\n * Cart Abstraction class\r\n */\r\nclass CartService {\r\n  /**\r\n   * Cart constructor\r\n   */\r\n  constructor() {\r\n    this._VTEX_API_ENDPOINT = '/api/checkout/pub/orderForm';\r\n\r\n    this._logger = new Logger('Cart service');\r\n    this._httpClient = new HttpClient();\r\n  }\r\n\r\n  /**\r\n   * Get current cart\r\n   * @return {*} Cart object\r\n   */\r\n  async getCurrent() {\r\n    return await this._httpClient.get(this._VTEX_API_ENDPOINT);\r\n  }\r\n\r\n  /**\r\n   * Add item to cart\r\n   * @param {*} skuId - Product sku Id (SKU)\r\n   * @param {*} productQuantity - Product Quantity\r\n   * @param {*} sellerId - Seller id\r\n   */\r\n  async add(skuId, productQuantity, sellerId = 1) {\r\n    // const payload = this._payloadFactory(skuId, productQuantity, sellerId);\r\n\r\n    if (!Ensure.isUndefined(skuId)) {\r\n      const current = await this.getCurrent();\r\n      const indexFound = current.items.findIndex(x => x.id === skuId);\r\n\r\n      if (indexFound > -1) {\r\n        productQuantity =\r\n          parseInt(productQuantity) +\r\n          parseInt(current.items[indexFound].quantity);\r\n      }\r\n\r\n      const endpointUrl = `${this._VTEX_API_ENDPOINT}/${current.orderFormId}/items`;\r\n\r\n      const payload = {\r\n        orderItems: [\r\n          {\r\n            seller: sellerId.toString(),\r\n            quantity: parseInt(productQuantity),\r\n            id: skuId.toString(),\r\n          },\r\n        ],\r\n      };\r\n\r\n      return this._httpClient.patch(endpointUrl, payload);\r\n    }\r\n  }\r\n\r\n  async checkoutCRUD(skus) {\r\n    let { items } = await window.vtexjs.checkout.getOrderForm();\r\n\r\n    const skusCustomProducts = this.getCustomProducts(skus);\r\n\r\n    skus = skus.filter(sku => !sku.isCustom);\r\n    skus = [...skus, ...skusCustomProducts];\r\n\r\n    const skuToIgnore = [19, 698, 25, 26];\r\n\r\n    const indexToRemove = items.reduce((indexList, item, index) => {\r\n      const customProductSKUs = [25, 26];\r\n\r\n      if (customProductSKUs.includes(parseInt(item.id))) {\r\n        return [...indexList, index];\r\n      }\r\n\r\n      return indexList;\r\n    }, []);\r\n\r\n    if (indexToRemove.length > 0) {\r\n      const response = await this.removeMoreProducts(indexToRemove);\r\n\r\n      response && (items = response.items);\r\n    }\r\n\r\n    const productsToAdd = skus\r\n      .filter(sku => sku.quantity > 0)\r\n      .filter(sku => {\r\n        let index = items.findIndex(\r\n          item => parseInt(item.productId) === parseInt(sku.productId)\r\n        );\r\n\r\n        return index === -1 && sku.quantity > 0;\r\n      })\r\n      .map(sku => ({\r\n        quantity: sku.quantity,\r\n        seller: 1,\r\n        id: sku.skuId || sku.id,\r\n      }));\r\n\r\n    console.log('productsToAdd', productsToAdd);\r\n\r\n    const productsToUpdate = skus\r\n      .filter(sku => sku.quantity > 0)\r\n      .filter(sku => {\r\n        const id = sku.skuId || sku.id;\r\n\r\n        let index = items.findIndex(item => parseInt(item.id) === parseInt(id));\r\n\r\n        if (index !== -1) {\r\n          const sameSku = parseInt(items[index].id) === parseInt(sku.id);\r\n          const diffQuantity =\r\n            parseInt(items[index].quantity) !== parseInt(sku.quantity);\r\n\r\n          return sameSku && diffQuantity && sku.quantity > 0;\r\n        }\r\n\r\n        return false;\r\n      })\r\n      .map(sku => {\r\n        const id = sku.skuId || sku.id;\r\n\r\n        let index = items.findIndex(item => parseInt(item.id) === parseInt(id));\r\n\r\n        return {\r\n          index,\r\n          quantity: sku.quantity,\r\n        };\r\n      });\r\n\r\n    console.log('productsToUpdate', productsToUpdate);\r\n\r\n    const productsToReplaceSKU = skus\r\n      .filter(\r\n        sku =>\r\n          sku.quantity > 0 &&\r\n          !skuToIgnore.includes(parseInt(sku.skuId || sku.id))\r\n      )\r\n      .filter(sku => {\r\n        const index = items.findIndex(\r\n          item => parseInt(item.productId) === parseInt(sku.productId)\r\n        );\r\n\r\n        if (index !== -1) {\r\n          const diffSku = parseInt(items[index].id) !== parseInt(sku.skuId);\r\n\r\n          return diffSku;\r\n        }\r\n\r\n        return false;\r\n      })\r\n      .map(sku => {\r\n        const index = items.findIndex(\r\n          item => parseInt(item.productId) === parseInt(sku.productId)\r\n        );\r\n\r\n        const oldSKU = {\r\n          index,\r\n          seller: 1,\r\n          quantity: 0,\r\n        };\r\n\r\n        const newSKU = {\r\n          seller: 1,\r\n          id: sku.skuId,\r\n          quantity: sku.quantity,\r\n        };\r\n\r\n        return [oldSKU, newSKU];\r\n      })\r\n      .reduce((itemsList, current) => {\r\n        const [oldSKU, newSKU] = current;\r\n\r\n        return [...itemsList, oldSKU, newSKU];\r\n      }, []);\r\n\r\n    console.log('productsToReplaceSKU', productsToReplaceSKU);\r\n\r\n    const productsToRemove = skus\r\n      .filter(sku => sku.quantity < 1)\r\n      .filter(sku => {\r\n        const id = sku.skuId || sku.id;\r\n\r\n        let index = items.findIndex(item => parseInt(item.id) === parseInt(id));\r\n\r\n        if (index !== -1) {\r\n          return sku.quantity == 0;\r\n        }\r\n\r\n        return false;\r\n      })\r\n      .map(sku => {\r\n        const id = sku.skuId || sku.id;\r\n\r\n        let index = items.findIndex(item => parseInt(item.id) === parseInt(id));\r\n\r\n        return {\r\n          index,\r\n          quantity: 0,\r\n        };\r\n      });\r\n\r\n    console.log('productsToRemove', productsToRemove);\r\n\r\n    if (productsToUpdate[0]) {\r\n      await window.vtexjs.checkout.updateItems(productsToUpdate, null, false);\r\n    }\r\n\r\n    if (productsToReplaceSKU[0]) {\r\n      await window.vtexjs.checkout.replaceSKU(productsToReplaceSKU);\r\n    }\r\n\r\n    if (productsToRemove[0]) {\r\n      await window.vtexjs.checkout.removeItems(productsToRemove);\r\n    }\r\n\r\n    if (productsToAdd[0]) {\r\n      await window.vtexjs.checkout.addToCart(productsToAdd, null);\r\n    }\r\n  }\r\n\r\n  getCustomProducts(skus) {\r\n    const customProducts = {};\r\n\r\n    skus\r\n      .filter(({ isCustom }) => isCustom === true)\r\n      .forEach(({ skuId, quantity, customProductItem }) => {\r\n        let currentCustomProduct = customProducts[skuId];\r\n\r\n        const customProductQuantity =\r\n          parseInt(customProductItem.quantity) * parseInt(quantity);\r\n\r\n        if (currentCustomProduct) {\r\n          const newQuantity =\r\n            parseInt(currentCustomProduct.quantity) + customProductQuantity;\r\n\r\n          currentCustomProduct = {\r\n            ...currentCustomProduct,\r\n            quantity: newQuantity,\r\n          };\r\n        } else {\r\n          currentCustomProduct = {\r\n            ...customProductItem,\r\n            quantity: customProductQuantity,\r\n            isCustom: true,\r\n          };\r\n        }\r\n\r\n        customProducts[skuId] = currentCustomProduct;\r\n      });\r\n\r\n    return Object.values(customProducts);\r\n  }\r\n\r\n  async getProductIndexInOrderForm(productId) {\r\n    const { items } = await this.getCurrent();\r\n\r\n    const index = items.findIndex(item => item.productId == productId);\r\n\r\n    if (index !== -1) return index;\r\n\r\n    return;\r\n  }\r\n\r\n  /**\r\n   * Remove item to cart\r\n   * @param {JSON} itemIndex - Product item index to be removed\r\n   */\r\n  async remove(itemIndex) {\r\n    const current = await this.getCurrent();\r\n    const endpointUrl = `${this._VTEX_API_ENDPOINT}/${current.orderFormId}/items`;\r\n    const payload = {\r\n      orderItems: [\r\n        {\r\n          index: itemIndex,\r\n          quantity: 0,\r\n        },\r\n      ],\r\n      expectedOrderFormSections: ['items'],\r\n      noSplitItem: true,\r\n    };\r\n\r\n    await this._httpClient.patch(endpointUrl, payload);\r\n  }\r\n\r\n  /**\r\n   * Remove items of cart\r\n   * @param {Array} itemsIndex - Products items index to be removed\r\n   */\r\n  async removeMoreProducts(itemsIndex) {\r\n    const current = await this.getCurrent();\r\n    const endpointUrl = `${this._VTEX_API_ENDPOINT}/${current.orderFormId}/items`;\r\n    const payload = {\r\n      orderItems: itemsIndex.map(index => ({\r\n        index,\r\n        quantity: 0,\r\n      })),\r\n      expectedOrderFormSections: ['items'],\r\n      noSplitItem: true,\r\n    };\r\n\r\n    return await this._httpClient.patch(endpointUrl, payload);\r\n  }\r\n\r\n  async updateProduct(skuId, quantity, seller = 1) {\r\n    const newSKU = {\r\n      seller,\r\n      quantity,\r\n      id: skuId,\r\n    };\r\n\r\n    return await this.updateProducts([newSKU]);\r\n  }\r\n\r\n  async updateProducts(skus) {\r\n    const { items, orderFormId } = await this.getCurrent();\r\n\r\n    skus = skus\r\n      .map(({ id, quantity, seller }) => {\r\n        const index = items.findIndex(\r\n          item => parseInt(item.id) === parseInt(id)\r\n        );\r\n\r\n        return {\r\n          id,\r\n          index,\r\n          quantity,\r\n          seller: seller || 1,\r\n        };\r\n      })\r\n      .filter(sku => sku.index !== -1);\r\n\r\n    if (skus.length > 0) {\r\n      const payload = {\r\n        orderItems: skus,\r\n      };\r\n\r\n      return await this._httpClient.patch(\r\n        `/api/checkout/pub/orderForm/${orderFormId}/items`,\r\n        payload\r\n      );\r\n    }\r\n  }\r\n\r\n  async simulateOrderForm(postalCode, country = 'BRA') {\r\n    try {\r\n      await vtexjs.checkout.getOrderForm();\r\n\r\n      const orderForm = await vtexjs.checkout.calculateShipping({\r\n        postalCode,\r\n        country,\r\n      });\r\n\r\n      return orderForm;\r\n    } catch (error) {\r\n      console.error('Error in simulateOrderForm', error);\r\n    }\r\n  }\r\n\r\n  async simulateShipping(items, postalCode, country = 'BRA') {\r\n    const orderFormSimulated = await vtexjs.checkout.simulateShipping(\r\n      items,\r\n      postalCode,\r\n      country\r\n    );\r\n\r\n    return orderFormSimulated;\r\n  }\r\n\r\n  async updateCheckoutTransporterSLA(logisticsInfo) {\r\n    await vtexjs.checkout.getOrderForm();\r\n\r\n    const { shippingData } = vtexjs.checkout.orderForm;\r\n\r\n    shippingData.logisticsInfo = logisticsInfo;\r\n\r\n    await vtexjs.checkout.sendAttachment('shippingData', shippingData);\r\n  }\r\n\r\n  async updateCheckoutAddress(address) {\r\n    console.log(address);\r\n    await vtexjs.checkout.getOrderForm();\r\n\r\n    const { shippingData } = vtexjs.checkout.orderForm;\r\n\r\n    shippingData.availableAddresses = [\r\n      {\r\n        ...shippingData.address,\r\n        ...address,\r\n      },\r\n    ];\r\n\r\n    shippingData.selectedAddresses = [\r\n      {\r\n        ...shippingData.address,\r\n        ...address,\r\n      },\r\n    ];\r\n\r\n    shippingData.address = {\r\n      ...shippingData.address,\r\n      ...address,\r\n    };\r\n\r\n    return await vtexjs.checkout.sendAttachment('shippingData', shippingData);\r\n  }\r\n\r\n  async setMultipleCustomDataFields(appName, fields) {\r\n    const { orderFormId } = await this.getCurrent();\r\n\r\n    const endpoint = `/api/checkout/pub/orderForm/${orderFormId}/customData/${appName}`;\r\n\r\n    try {\r\n      return await this._httpClient.put(endpoint, fields);\r\n    } catch (error) {\r\n      console.error('setMultipleCustomDataFields', error);\r\n    }\r\n\r\n    return;\r\n  }\r\n\r\n  async setSingleCustomDataField(appName, appFieldName, appFieldValue) {\r\n    const { orderFormId } = await this.getCurrent();\r\n\r\n    const endpoint = `/api/checkout/pub/orderForm/${orderFormId}/customData/${appName}/${appFieldName}`;\r\n\r\n    const payload = { value: appFieldValue };\r\n\r\n    try {\r\n      return await this._httpClient.put(endpoint, payload);\r\n    } catch (error) {\r\n      console.error('setSingleCustomDataField', error);\r\n    }\r\n\r\n    return;\r\n  }\r\n\r\n  async removeSingleCustomDataField(appName, appFieldName) {\r\n    const { orderFormId } = await this.getCurrent();\r\n\r\n    const endpoint = `/api/checkout/pub/orderForm/${orderFormId}/customData/${appName}/${appFieldName}`;\r\n\r\n    const payload = { value: null };\r\n\r\n    try {\r\n      return await this._httpClient.delete(endpoint, payload);\r\n    } catch (error) {\r\n      console.error('removeSingleCustomDataField', error);\r\n    }\r\n\r\n    return;\r\n  }\r\n\r\n  /**\r\n   * Cart's payload method factory\r\n   * @param {*} skuId - Product Id (SKU)\r\n   * @param {*} productQuantity - Product Quantity\r\n   * @param {*} sellerId - Seller id\r\n   * @return {JSON} cart paylod\r\n   */\r\n  _payloadFactory(skuId, productQuantity, sellerId = 1) {\r\n    return {\r\n      id: skuId,\r\n      quantity: productQuantity,\r\n      seller: sellerId,\r\n    };\r\n  }\r\n}\r\n\r\nexport default CartService;\r\n","// Commons\r\nimport { Helper } from 'Commons';\r\n\r\n// Components\r\nimport ModalComponent from 'Components/b8one.modalComponent.js';\r\n\r\n// Services\r\nimport HttpClient from 'Services/b8one.httpClient';\r\nimport CartService from 'Services/b8one.cartService.js';\r\nimport StorageService from 'Services/b8one.storageService.js';\r\nimport InsuranceService from 'Services/b8one.insuranceService.js';\r\n\r\n// Utils\r\nimport { REAL } from 'Utils/currency/';\r\nimport SKUS_TO_IGNORE from 'Utils/skusToIgnore';\r\n\r\n// Dependencies\r\nimport flatpickr from 'flatpickr';\r\nimport { Portuguese } from 'flatpickr/dist/l10n/pt.js';\r\nimport 'dayjs/locale/pt-br';\r\nimport dayjs from 'dayjs';\r\n\r\nclass OrderSummaryPage {\r\n  constructor() {\r\n    this.products = {};\r\n    this.addressCep = null;\r\n    this.logisticsInfo = null;\r\n    this.modalRemoveProductInstance = null;\r\n    this.dateSelected = null;\r\n    this.modalDate = null;\r\n    this.calendarInstance = null;\r\n    this.insuranceItems = {};\r\n    this.cartService = new CartService();\r\n    this.httpClient = new HttpClient();\r\n    this.storageService = new StorageService();\r\n    this.insuranceService = new InsuranceService();\r\n    this.helper = new Helper();\r\n    this.userIsDefined = null;\r\n\r\n    this.orderForm = {};\r\n\r\n    this.transporterSelected;\r\n    this.totalInsuranceFormatted;\r\n\r\n    this.totalInsurance = REAL('R$ 0,00');\r\n    this.totalOrderSummary = REAL('R$ 0,00');\r\n    this.totalTransporterSelected = REAL('R$ 0,00');\r\n    this.totalStorageMonth = 'R$ 0,00';\r\n    this.totalStorage = REAL('R$ 0,00');\r\n    this.userSelectedStorageMonths = 1;\r\n\r\n    this.totalizers = [];\r\n    this.customSelectStorageServiceInstance = null;\r\n    this.logisticsInfo = [];\r\n\r\n    this.liftingQuantity = 0;\r\n    this.lifting = 'iamento na origem e destino';\r\n\r\n    this.tableContentElement = document.querySelector(\r\n      '.summary-table .table__content'\r\n    );\r\n\r\n    window.OrderSummaryPage = this;\r\n\r\n    this.init();\r\n  }\r\n\r\n  async init() {\r\n    const user = await $.get('/no-cache/profileSystem/getProfile');\r\n    this.userIsDefined = user.IsUserDefined;\r\n\r\n    this.initModalRemoveProduct();\r\n    this.initModalDate();\r\n    this.initTermsModal();\r\n    this.setHandledTermsCheckboxChange();\r\n    this.handleGoToPaymentButton();\r\n\r\n    this.setHandledButtonEditDateClick();\r\n    this.setHandledButtonSaveClick();\r\n\r\n    this.updateOrderForm(await this.cartService.getCurrent());\r\n\r\n    await this.updateShippingData();\r\n\r\n    this.logisticsInfo = this.orderForm.shippingData.logisticsInfo;\r\n\r\n    this.setTransporterSelected();\r\n    this.setTotalInsurance();\r\n    this.getProductsInCustomData();\r\n    this.setDate();\r\n    this.getAddress();\r\n    this.getInsuranceItems();\r\n    this.setAddressCep();\r\n    this.getLiftingFromCustomData();\r\n\r\n    this.addServicesToDOM();\r\n\r\n    this.updateSelectedSLA();\r\n\r\n    this.initCalendar();\r\n\r\n    this.setTotalTransporterSelected();\r\n    this.setTotalOrderSummary();\r\n\r\n    this.setTotalOrderSummaryElement();\r\n\r\n    const transporterHTML = this.createTransporterElement(\r\n      this.transporterSelected\r\n    );\r\n    const orderFormProductsHTML = this.createProductstInOrderForm();\r\n    const customProductsHTML = this.createCustomProducts();\r\n\r\n    this.addTransporterToDOM(transporterHTML);\r\n    this.addOrderFormProductsToDOM(orderFormProductsHTML);\r\n    this.addCustomProductsToDOM(customProductsHTML);\r\n\r\n    document\r\n      .querySelector('a[href=\"#entenda-o-prazo-de-entrega-da-sua-mudanca\"]')\r\n      .addEventListener('click', e => {\r\n        e.preventDefault();\r\n\r\n        const shippingDateContainer = document.querySelector(\r\n          '#entenda-o-prazo-de-entrega-da-sua-mudanca'\r\n        );\r\n        const header = document.querySelector('.header');\r\n\r\n        window.scrollTo(\r\n          0,\r\n          shippingDateContainer.offsetTop - (header.offsetHeight + 48)\r\n        );\r\n      });\r\n\r\n    this.setHandledProducts();\r\n    this.setHandledTransporterElement();\r\n    this.setHandledUpdateButtonClick();\r\n\r\n    this.removePageLoading();\r\n  }\r\n\r\n  updateOrderForm(orderForm) {\r\n    if (orderForm) {\r\n      this.orderForm = orderForm;\r\n    }\r\n  }\r\n\r\n  getLiftingFromCustomData() {\r\n    const { customData } = this.orderForm;\r\n\r\n    if (!customData) return;\r\n\r\n    customData.customApps\r\n      .filter(customApp => customApp.id === 'orderinfo')\r\n      .forEach(customApp => {\r\n        const { lifting } = customApp.fields;\r\n\r\n        if (lifting) {\r\n          this.lifting = lifting;\r\n        }\r\n      });\r\n  }\r\n\r\n  initCalendar() {\r\n    this.calendarInstance = flatpickr('.js-calendar', {\r\n      inline: true,\r\n      dateFormat: 'd/m/Y',\r\n      minDate: new Date().fp_incr(7),\r\n      defaultDate: this.dateSelected,\r\n      locale: Portuguese,\r\n      appendTo: document.querySelector('.js-calendar'),\r\n      prevArrow: '<i class=\"fas fa-caret-left next-month-icon-left\"></i>',\r\n      nextArrow: '<i class=\"fas fa-caret-right next-month-icon-right\"></i>',\r\n      disable: [\r\n        function(date) {\r\n          return date.getDay() === 0 || date.getDay() === 6;\r\n        },\r\n      ],\r\n    });\r\n\r\n    this.calendarInstance.setDate(new Date(this.dateSelected));\r\n  }\r\n\r\n  initTermsModal() {\r\n    const modal = document.querySelector('.modal__terms');\r\n    const btnContinue = modal.querySelector('.js-button-continue');\r\n    const btnClose = modal.querySelector('.js-button-close-modal');\r\n\r\n    this.modalTerms = new ModalComponent({\r\n      modal: modal,\r\n      modalShowCLass: 'wrapper-modal--show',\r\n    });\r\n\r\n    btnContinue.addEventListener('click', async () => {\r\n      btnContinue.classList.add('js-loading');\r\n\r\n      await this.saveData();\r\n\r\n      this.updateInsuranceValue();\r\n\r\n      await this.updateTranspoterValue();\r\n\r\n      btnContinue.classList.remove('js-loading');\r\n\r\n      if (this.userIsDefined) {\r\n        window.location.assign('/checkout/#/payment');\r\n      } else {\r\n        this.loginUser();\r\n      }\r\n    });\r\n\r\n    btnClose.addEventListener('click', () => this.modalTerms.close());\r\n  }\r\n\r\n  async updateShippingData() {\r\n    if (this.userIsDefined) {\r\n      const { customData, totalizers, clientProfileData } = this.orderForm;\r\n\r\n      if (!customData) return;\r\n\r\n      const customAppOrderInfo = customData.customApps.filter(\r\n        customApp => customApp.id === 'orderinfo'\r\n      )[0];\r\n\r\n      if (customAppOrderInfo) {\r\n        const address = {\r\n          addressType: 'residential',\r\n          city: customAppOrderInfo.fields.to_city,\r\n          neighborhood: customAppOrderInfo.fields.to_address_county,\r\n          number: customAppOrderInfo.fields.to_address_number,\r\n          postalCode: customAppOrderInfo.fields.to_address_zipcode,\r\n          state: customAppOrderInfo.fields.to_state,\r\n          street: customAppOrderInfo.fields.to_address_name,\r\n          receiverName:\r\n            clientProfileData.firstName && clientProfileData.lastName\r\n              ? `${clientProfileData.firstName} ${clientProfileData.lastName}`\r\n              : clientProfileData.email.split('@')[0].replace(/\\W/g, ''),\r\n        };\r\n\r\n        const shippingTotalizer = totalizers.filter(\r\n          ({ id }) => id === 'Shipping'\r\n        )[0];\r\n\r\n        const orderInfoApp = customData.customApps.filter(\r\n          customApp => customApp.id === 'orderinfo'\r\n        )[0];\r\n\r\n        if (!shippingTotalizer) {\r\n          await window.vtexjs.checkout.getOrderForm();\r\n          await window.vtexjs.checkout.calculateShipping({\r\n            postalCode: orderInfoApp.fields.to_address_zipcode,\r\n            country: 'BRA',\r\n          });\r\n        }\r\n\r\n        this.updateOrderForm(\r\n          await this.cartService.updateCheckoutAddress(address)\r\n        );\r\n\r\n        this.updateOrderForm(\r\n          await this.cartService.updateCheckoutTransporterSLA(\r\n            this.logisticsInfo\r\n          )\r\n        );\r\n\r\n        if (window.location.search.indexOf('?logged=true') > -1) {\r\n          await window.vtexjs.checkout.clearMessages();\r\n\r\n          window.location.assign('/checkout/#/payment');\r\n        }\r\n      }\r\n    }\r\n\r\n    return;\r\n  }\r\n\r\n  loginUser() {\r\n    vtexid.start({\r\n      returnUrl: `${window.location.href}?logged=true`,\r\n      locale: 'pt-BR',\r\n      forceReload: false,\r\n    });\r\n\r\n    window.scrollTo(0, 0);\r\n  }\r\n\r\n  handleGoToPaymentButton() {\r\n    const btn = document.querySelector('.js-toPayment-button');\r\n\r\n    btn.addEventListener('click', () => {\r\n      this.modalTerms.show();\r\n    });\r\n  }\r\n\r\n  setHandledTermsCheckboxChange() {\r\n    const modalTerms = document.querySelector('.modal__terms');\r\n    const buttonContinue = document.querySelector(\r\n      '.modal__terms .js-button-continue'\r\n    );\r\n\r\n    modalTerms.addEventListener('change', e => {\r\n      const inputCheckboxes = [\r\n        ...document.querySelectorAll('.modal__terms .modal__fakeInput'),\r\n      ];\r\n\r\n      const allChecked = !inputCheckboxes\r\n        .map(input => input.checked)\r\n        .includes(false);\r\n\r\n      if (allChecked) {\r\n        buttonContinue.removeAttribute('disabled');\r\n      } else {\r\n        buttonContinue.setAttribute('disabled', true);\r\n      }\r\n    });\r\n  }\r\n\r\n  setTotalTransporterSelected() {\r\n    const { priceFormatted } = this.transporterSelected.deliveryTypeSelected;\r\n\r\n    this.totalTransporterSelected = this.totalTransporterSelected.add(\r\n      priceFormatted\r\n    );\r\n  }\r\n\r\n  setTotalInsurance() {\r\n    const { customData } = this.orderForm;\r\n\r\n    if (!customData) return;\r\n\r\n    customData.customApps\r\n      .filter(customApp => customApp.id === 'insurance')\r\n      .forEach(customApp => {\r\n        const { total } = customApp.fields;\r\n\r\n        if (total) {\r\n          this.totalInsurance = this.totalInsurance.add(total);\r\n          this.totalInsuranceFormatted = this.totalInsurance.format();\r\n        }\r\n      });\r\n  }\r\n\r\n  setTotalOrderSummaryElement() {\r\n    const totalOrderSummaryElements = document.querySelectorAll(\r\n      '.js-total-order-summary'\r\n    );\r\n\r\n    totalOrderSummaryElements.forEach(item => {\r\n      item.textContent = this.totalOrderSummary.format();\r\n    });\r\n  }\r\n\r\n  setTotalOrderSummary() {\r\n    this.totalOrderSummary = this.totalOrderSummary\r\n      .add(this.totalTransporterSelected.format())\r\n      .add(this.totalInsurance.multiply(0.01).format());\r\n  }\r\n\r\n  initModalRemoveProduct() {\r\n    const modalRemoveProduct = document.querySelector('.modal--remove-product');\r\n    const modalRemoveProductButtonClose = modalRemoveProduct.querySelector(\r\n      '.modal__close'\r\n    );\r\n\r\n    const buttonRemoveProduct = modalRemoveProduct.querySelector(\r\n      '.js-button-remove-product'\r\n    );\r\n\r\n    const buttonCancelRemove = modalRemoveProduct.querySelector(\r\n      '.js-button-cancel-remove-product'\r\n    );\r\n\r\n    this.modalRemoveProductInstance = new ModalComponent({\r\n      modal: modalRemoveProduct,\r\n      modalShowCLass: 'wrapper-modal--show',\r\n      closeModalCallback: () => {\r\n        if (Object.keys(this.products).length == 1) {\r\n          this.hideErrorRemoveProductMessage();\r\n        }\r\n      },\r\n    });\r\n\r\n    buttonRemoveProduct.addEventListener('click', ({ target }) => {\r\n      const { productIdToRemove } = target.dataset;\r\n\r\n      if (Object.keys(this.products).length > 1) {\r\n        this.handledConfirmRemoveProduct(\r\n          productIdToRemove,\r\n          this.products[productIdToRemove]\r\n        );\r\n        this.modalRemoveProductInstance.close();\r\n      } else {\r\n        this.showErrorRemoveProductMessage();\r\n      }\r\n    });\r\n\r\n    [modalRemoveProductButtonClose, buttonCancelRemove].forEach(button => {\r\n      button.addEventListener('click', e =>\r\n        this.modalRemoveProductInstance.close()\r\n      );\r\n    });\r\n  }\r\n\r\n  showErrorRemoveProductMessage() {\r\n    const modalRemoveErrorMessageElement = document.querySelector(\r\n      '.modal--remove-product .modal__paragraph--error'\r\n    );\r\n\r\n    modalRemoveErrorMessageElement.classList.add(\r\n      'modal__paragraph--error-show'\r\n    );\r\n  }\r\n\r\n  hideErrorRemoveProductMessage() {\r\n    const modalRemoveErrorMessageElement = document.querySelector(\r\n      '.modal--remove-product .modal__paragraph--error'\r\n    );\r\n\r\n    modalRemoveErrorMessageElement.classList.remove(\r\n      'modal__paragraph--error-show'\r\n    );\r\n  }\r\n\r\n  initModalDate() {\r\n    const modalDate = document.querySelector('.modal-date');\r\n\r\n    const modalDateButtonClose = modalDate.querySelector('.modal__close');\r\n\r\n    const buttonContinue = modalDate.querySelector('.js-button-continue');\r\n\r\n    const buttonCancel = modalDate.querySelector('.js-button-cancel');\r\n\r\n    this.modalDate = new ModalComponent({\r\n      modal: modalDate,\r\n      modalShowCLass: 'wrapper-modal--show',\r\n    });\r\n\r\n    buttonContinue.addEventListener('click', ({ target }) => {\r\n      const formattedDate = this.calendarInstance.formatDate(\r\n        this.calendarInstance.selectedDates[0],\r\n        'Y/m/d'\r\n      );\r\n\r\n      this.dateSelected = formattedDate;\r\n\r\n      this.updateCalendarComponent(formattedDate);\r\n\r\n      this.modalDate.close();\r\n    });\r\n\r\n    [modalDateButtonClose, buttonCancel].forEach(button => {\r\n      button.addEventListener('click', e => this.modalDate.close());\r\n    });\r\n  }\r\n\r\n  setHandledButtonEditDateClick() {\r\n    const buttonEdit = document.querySelector('.card__button--edit');\r\n\r\n    buttonEdit.addEventListener('click', e => {\r\n      this.modalDate.show();\r\n    });\r\n  }\r\n\r\n  setHandledTransporterElement() {\r\n    const transporter = document.querySelector('.transporter');\r\n\r\n    const priceElements = [...transporter.querySelectorAll('.price')];\r\n\r\n    priceElements.forEach(priceElement => {\r\n      priceElement.addEventListener('change', event => {\r\n        const prevPriceElementActive = document.querySelector('.price--active');\r\n\r\n        if (prevPriceElementActive) {\r\n          prevPriceElementActive.classList.remove('price--active');\r\n\r\n          const prevPriceElementActiveCheckbox = prevPriceElementActive.querySelector(\r\n            'input[type=\"checkbox\"]'\r\n          );\r\n\r\n          prevPriceElementActiveCheckbox.checked = false;\r\n        }\r\n\r\n        priceElement.classList.add('price--active');\r\n\r\n        const priceElementCheckbox = priceElement.querySelector(\r\n          'input[type=\"checkbox\"]'\r\n        );\r\n\r\n        priceElementCheckbox.checked = true;\r\n\r\n        const { transporterDeliveryType } = priceElement.dataset;\r\n\r\n        transporter.setAttribute(\r\n          'data-transporter-delivery-type-selected',\r\n          transporterDeliveryType\r\n        );\r\n\r\n        this.setTransporterSelected(transporter);\r\n      });\r\n    });\r\n  }\r\n\r\n  setHandledProduct(product) {\r\n    const buttonMinusQuantity = product.querySelector(\r\n      '.product__quantity--minus'\r\n    );\r\n    const buttonAddQuantity = product.querySelector('.product__quantity--add');\r\n    const inputCheckbox = product.querySelector('.js-input-special-packaging');\r\n\r\n    const buttonRemove = product.querySelector('.product__remove-button');\r\n\r\n    const inputProductQuantity = product.querySelector('.product__quantity');\r\n    const inputProductActive = product.querySelector(\r\n      '.js-input-product-active'\r\n    );\r\n\r\n    buttonMinusQuantity.addEventListener('click', event =>\r\n      this.handledMinusQuantityProduct(event, product)\r\n    );\r\n\r\n    buttonAddQuantity.addEventListener('click', event =>\r\n      this.handledAddQuantityProduct(event, product)\r\n    );\r\n\r\n    inputCheckbox &&\r\n      inputCheckbox.addEventListener('change', event =>\r\n        this.handledSpecialPackagingProduct(event, product)\r\n      );\r\n\r\n    buttonRemove.addEventListener('click', event =>\r\n      this.handledRemoveProductClick(event, product)\r\n    );\r\n\r\n    inputProductQuantity.addEventListener('input', event =>\r\n      this.handledProductQuantityChange(event, product)\r\n    );\r\n\r\n    inputProductActive.addEventListener('change', event =>\r\n      this.handledProductActiveChange(event, product)\r\n    );\r\n  }\r\n\r\n  setHandledProducts() {\r\n    const products = [...document.querySelectorAll('.summary-table .product')];\r\n\r\n    products.forEach(product => this.setHandledProduct(product));\r\n  }\r\n\r\n  setTotalizers(totalizers) {\r\n    this.totalizers = totalizers;\r\n  }\r\n\r\n  setTransporterSelected(transporterElement = null) {\r\n    if (!transporterElement) {\r\n      const { customData } = this.orderForm;\r\n\r\n      if (!customData) return;\r\n\r\n      customData.customApps\r\n        .filter(customApp => customApp.id === 'selectedcourier')\r\n        .forEach(customApp => {\r\n          const { courier_data } = customApp.fields;\r\n\r\n          this.transporterSelected = JSON.parse(courier_data);\r\n\r\n          this.orderDeliveryTypesByLessPrice();\r\n        });\r\n    } else {\r\n      const { transporterDeliveryTypeSelected } = transporterElement.dataset;\r\n\r\n      this.transporterSelected.deliveryTypeSelected = this.transporterSelected.deliveryTypes.filter(\r\n        ({ type }) => type === transporterDeliveryTypeSelected\r\n      )[0];\r\n    }\r\n  }\r\n\r\n  handledAddQuantityProduct(event, product) {\r\n    const { productId } = product.dataset;\r\n    const productQuantityElement = product.querySelector('.product__quantity');\r\n\r\n    const quantity = (product.dataset.productQuantity = ++productQuantityElement.value);\r\n\r\n    this.products[productId].quantity = parseInt(quantity);\r\n\r\n    this.products[productId].liftingQuantity = this.products[productId]\r\n      .requiresLifting\r\n      ? 1 * parseInt(quantity)\r\n      : 0;\r\n\r\n    if (this.lifting === 'iamento na origem e destino') {\r\n      this.products[productId].liftingQuantityOrigin = this.products[\r\n        productId\r\n      ].liftingQuantity;\r\n      this.products[productId].liftingQuantityDestination = this.products[\r\n        productId\r\n      ].liftingQuantity;\r\n    } else if (this.lifting === 'iamento no origem') {\r\n      this.products[productId].liftingQuantityOrigin = this.products[\r\n        productId\r\n      ].liftingQuantity;\r\n    } else {\r\n      this.products[productId].liftingQuantityDestination = this.products[\r\n        productId\r\n      ].liftingQuantity;\r\n    }\r\n  }\r\n\r\n  handledMinusQuantityProduct(event, product) {\r\n    const { productId, productQuantity } = product.dataset;\r\n    const productQuantityElement = product.querySelector('.product__quantity');\r\n\r\n    if (productQuantity * 1 > 1) {\r\n      const newQuantity = (product.dataset.productQuantity = --productQuantityElement.value);\r\n\r\n      this.products[productId].quantity = parseInt(newQuantity);\r\n\r\n      this.products[productId].liftingQuantity = this.products[productId]\r\n        .requiresLifting\r\n        ? 1 * parseInt(newQuantity)\r\n        : 0;\r\n\r\n      if (this.lifting === 'iamento na origem e destino') {\r\n        this.products[productId].liftingQuantityOrigin = this.products[\r\n          productId\r\n        ].liftingQuantity;\r\n        this.products[productId].liftingQuantityDestination = this.products[\r\n          productId\r\n        ].liftingQuantity;\r\n      } else if (this.lifting === 'iamento no origem') {\r\n        this.products[productId].liftingQuantityOrigin = this.products[\r\n          productId\r\n        ].liftingQuantity;\r\n      } else {\r\n        this.products[productId].liftingQuantityDestination = this.products[\r\n          productId\r\n        ].liftingQuantity;\r\n      }\r\n    }\r\n  }\r\n\r\n  handledProductQuantityChange(event, product) {\r\n    const { value } = event.target;\r\n    const { productId } = product.dataset;\r\n\r\n    if (value > 0) {\r\n      this.products[productId].quantity = parseInt(value);\r\n      product.dataset.productQuantity = value;\r\n\r\n      this.products[productId].liftingQuantity = this.products[productId]\r\n        .requiresLifting\r\n        ? 1 * parseInt(value)\r\n        : 0;\r\n\r\n      if (this.lifting === 'iamento na origem e destino') {\r\n        this.products[productId].liftingQuantityOrigin = this.products[\r\n          productId\r\n        ].liftingQuantity;\r\n        this.products[productId].liftingQuantityDestination = this.products[\r\n          productId\r\n        ].liftingQuantity;\r\n      } else if (this.lifting === 'iamento no origem') {\r\n        this.products[productId].liftingQuantityOrigin = this.products[\r\n          productId\r\n        ].liftingQuantity;\r\n      } else {\r\n        this.products[productId].liftingQuantityDestination = this.products[\r\n          productId\r\n        ].liftingQuantity;\r\n      }\r\n    }\r\n  }\r\n\r\n  handledSpecialPackagingProduct(event, product) {\r\n    const { checked } = event.target;\r\n    let { productId, skuIdWithBox, skuIdWithoutBox } = product.dataset;\r\n\r\n    product.dataset.productSpecialPackaging = checked;\r\n\r\n    const currentProduct = this.products[productId];\r\n\r\n    skuIdWithBox *= 1;\r\n    skuIdWithoutBox *= 1;\r\n\r\n    currentProduct.specialPackaging = checked;\r\n    currentProduct.skuId = checked ? skuIdWithBox : skuIdWithoutBox;\r\n\r\n    if (currentProduct.isCustom) {\r\n      currentProduct.customProductItem.id = currentProduct.skuId;\r\n    }\r\n  }\r\n\r\n  handledProductActiveChange(event, product) {\r\n    const { checked } = event.target;\r\n    const { productId } = product.dataset;\r\n\r\n    this.products[productId].active = checked;\r\n  }\r\n\r\n  createProductForModalRemove(productName, imgURL, description = '') {\r\n    const productHTML = document.createElement('article');\r\n\r\n    productHTML.setAttribute('class', 'product');\r\n\r\n    productHTML.innerHTML += `\r\n      <figure class=\"product__figure\">\r\n        <img \r\n          class=\"product__image js-modal-product-image\"\r\n          src=\"${imgURL}\"\r\n          alt=\"${productName}\"\r\n        />\r\n      </figure>\r\n    \r\n      <div class=\"product__group\">\r\n        <h3 class=\"product__name js-modal-product-name\">\r\n          ${productName}\r\n        </h3>\r\n        \r\n        <div class=\"product__attributes\">\r\n          <p class=\"attributes__item js-modal-product-attribute-item\">\r\n            ${description}\r\n          </p>\r\n        </div>\r\n      </div>\r\n    `;\r\n\r\n    return productHTML;\r\n  }\r\n\r\n  createCustomProductForModalRemove(productName, description = '') {\r\n    const productHTML = document.createElement('article');\r\n\r\n    productHTML.setAttribute('class', 'product');\r\n\r\n    productHTML.innerHTML += `\r\n      <div class=\"product__icon-container\">\r\n        <i class=\"far fa-box product__icon\"></i>\r\n      </div>\r\n    \r\n      <div class=\"product__group\">\r\n        <h3 class=\"product__name js-modal-product-name\">\r\n          ${productName}\r\n        </h3>\r\n        \r\n        <div class=\"product__attributes\">\r\n          <p class=\"attributes__item js-modal-product-attribute-item\">\r\n            ${description}\r\n          </p>\r\n        </div>\r\n      </div>\r\n    `;\r\n\r\n    return productHTML;\r\n  }\r\n\r\n  async handledConfirmRemoveProduct(productId, productData) {\r\n    const productElement = document.querySelector(\r\n      `[data-product-id=\"${productId}\"]`\r\n    );\r\n\r\n    if (!productData.isCustom) {\r\n      const productIndex = this.orderForm.items.findIndex(\r\n        item => item.productId == productId\r\n      );\r\n\r\n      if (productIndex !== -1) {\r\n        await this.cartService.remove(productIndex);\r\n      }\r\n    }\r\n\r\n    delete this.products[productId];\r\n    delete this.insuranceItems[productId];\r\n\r\n    this.updateOrderForm(await this.cartService.getCurrent());\r\n\r\n    await this.saveData();\r\n\r\n    this.updateInsuranceValue();\r\n\r\n    await this.updateTranspoterValue();\r\n\r\n    this.updateTotalOrderValue();\r\n\r\n    productElement.parentElement.remove();\r\n  }\r\n\r\n  handledRemoveProductClick(event, product) {\r\n    let productHTML;\r\n    const { productId } = product.dataset;\r\n    const { isCustom } = this.products[productId];\r\n\r\n    const productNameElement = product.querySelector('.product__name');\r\n    const productImageElement = product.querySelector('.product__image');\r\n    const productAttributeElement = product.querySelector('.attributes__item');\r\n\r\n    const modalRemoveProduct = document.querySelector('.modal--remove-product');\r\n    const modalProductContainer = modalRemoveProduct.querySelector(\r\n      '.product__container'\r\n    );\r\n\r\n    const buttonRemoveProduct = modalRemoveProduct.querySelector(\r\n      '.js-button-remove-product'\r\n    );\r\n\r\n    const oldProduct = modalRemoveProduct.querySelector('.product');\r\n\r\n    oldProduct && oldProduct.remove();\r\n\r\n    if (isCustom) {\r\n      productHTML = this.createCustomProductForModalRemove(\r\n        productNameElement.textContent\r\n        // productAttributeElement.textContent\r\n      );\r\n    } else {\r\n      productHTML = this.createProductForModalRemove(\r\n        productNameElement.textContent,\r\n        productImageElement.src\r\n        // productAttributeElement.textContent\r\n      );\r\n    }\r\n\r\n    modalProductContainer.prepend(productHTML);\r\n\r\n    buttonRemoveProduct.setAttribute('data-product-id-to-remove', productId);\r\n\r\n    this.modalRemoveProductInstance.show();\r\n  }\r\n\r\n  updateInsuranceValue(isSimulate = false) {\r\n    if (['skipped', 'none'].includes(this.insuranceItems)) return;\r\n\r\n    const newInsuranceValue = Object.values(this.insuranceItems)\r\n      .filter(({ productId }) => this.products[productId].active)\r\n      .reduce((total, insuranceItem) => {\r\n        return total.add(insuranceItem.totalInsuranceFormatted);\r\n      }, REAL('R$ 0,00'));\r\n\r\n    this.totalInsurance = newInsuranceValue;\r\n  }\r\n\r\n  async updateTranspoterValue(isSimulate = false) {\r\n    const { items, totalizers } = this.orderForm;\r\n\r\n    this.setTotalizers(totalizers);\r\n\r\n    const insuranceSKU = items.filter(({ id }) => parseInt(id) === 35)[0];\r\n\r\n    const totalItemsWithDiscounts = this.totalizers\r\n      .filter(total => total.id !== 'Shipping')\r\n      .reduce((total, totalizer) => total + totalizer.value, 0);\r\n\r\n    const activeProductsWithoutCustoms = Object.values(this.products)\r\n      .filter(\r\n        product => product.active && !SKUS_TO_IGNORE.includes(product.skuId)\r\n      )\r\n      .map(({ quantity, skuId }) => ({\r\n        quantity,\r\n        seller: 1,\r\n        id: skuId,\r\n      }));\r\n\r\n    let activeProductsCustoms = Object.values(this.products)\r\n      .filter(product => product.active && product.isCustom)\r\n      .reduce((customProducts, customProduct) => {\r\n        const { quantity, id } = customProduct.customProductItem;\r\n\r\n        const newQuantity = quantity * customProduct.quantity;\r\n\r\n        if (customProducts[id]) {\r\n          customProducts[id].quantity =\r\n            customProducts[id].quantity + newQuantity;\r\n        } else {\r\n          customProducts[id] = {\r\n            id,\r\n            quantity: newQuantity,\r\n            seller: 1,\r\n          };\r\n        }\r\n\r\n        return customProducts;\r\n      }, {});\r\n\r\n    activeProductsCustoms = Object.values(activeProductsCustoms);\r\n\r\n    const storageSKU = items\r\n      .filter(item => parseInt(item.id) === 33)\r\n      .map(({ id, quantity }) => ({ id, quantity, seller: 1 }))[0];\r\n\r\n    const liftingSKUS = items\r\n      .filter(item => parseInt(item.productId) === 10)\r\n      .map(({ id, quantity }) => ({ id, quantity, seller: 1 }));\r\n\r\n    let activeProducts = [\r\n      ...activeProductsWithoutCustoms,\r\n      ...activeProductsCustoms,\r\n    ];\r\n\r\n    if (storageSKU) {\r\n      activeProducts.push(storageSKU);\r\n    }\r\n\r\n    if (liftingSKUS.length > 0) {\r\n      activeProducts = [...activeProducts, ...liftingSKUS];\r\n    }\r\n\r\n    const { logisticsInfo } = await this.cartService.simulateShipping(\r\n      activeProducts,\r\n      this.addressCep\r\n    );\r\n\r\n    this.logisticsInfo = logisticsInfo.filter(logisticInfo => {\r\n      const ids = this.transporterSelected.courierIds.split(';');\r\n\r\n      logisticInfo.slas = logisticInfo.slas.filter(sla => {\r\n        return ids.includes(sla.deliveryIds[0].courierId);\r\n      });\r\n\r\n      return logisticInfo;\r\n    });\r\n\r\n    this.getDeliveryTypes();\r\n\r\n    this.transporterSelected.deliveryTypes = this.transporterSelected.deliveryTypes.map(\r\n      deliveryType => {\r\n        let newPrice = logisticsInfo.reduce((total, logisticInfo) => {\r\n          const currentSLA = logisticInfo.slas.filter(\r\n            sla => sla.id === deliveryType.slaName\r\n          )[0];\r\n\r\n          return total + currentSLA.price;\r\n        }, 0);\r\n\r\n        newPrice += insuranceSKU\r\n          ? totalItemsWithDiscounts + -insuranceSKU.manualPrice\r\n          : totalItemsWithDiscounts;\r\n\r\n        const newPriceFormatted = this.helper.formatPrice(newPrice);\r\n\r\n        return {\r\n          ...deliveryType,\r\n          price: newPrice,\r\n          priceFormatted: newPriceFormatted,\r\n        };\r\n      }\r\n    );\r\n\r\n    this.transporterSelected.deliveryTypeSelected = this.transporterSelected.deliveryTypes.filter(\r\n      deliveryType =>\r\n        deliveryType.slaName ===\r\n        this.transporterSelected.deliveryTypeSelected.slaName\r\n    )[0];\r\n\r\n    this.totalTransporterSelected = REAL(\r\n      this.transporterSelected.deliveryTypeSelected.priceFormatted\r\n    );\r\n\r\n    this.updateTransporterElement();\r\n  }\r\n\r\n  updateTransporterElement() {\r\n    this.transporterSelected.deliveryTypes.forEach(deliveryType => {\r\n      const priceElement = document.querySelector(\r\n        `[data-transporter-delivery-type=\"${deliveryType.type}\"]`\r\n      );\r\n\r\n      const priceTotalElement = priceElement.querySelector('.price__total');\r\n\r\n      priceTotalElement.textContent = deliveryType.priceFormatted;\r\n    });\r\n  }\r\n\r\n  updateTotalOrderValue() {\r\n    this.totalOrderSummary = REAL('R$ 0,00');\r\n\r\n    this.setTotalOrderSummary();\r\n    this.setTotalOrderSummaryElement();\r\n  }\r\n\r\n  getTransporterVariations(logisticsInfo) {\r\n    const transporterVariations = {};\r\n\r\n    logisticsInfo.forEach(({ slas }) => {\r\n      slas.forEach(({ id, price, name }) => {\r\n        const key = id.toLowerCase().replace(/\\s/g, '');\r\n\r\n        if (transporterVariations[key]) {\r\n          transporterVariations[key].price += price;\r\n        } else {\r\n          transporterVariations[key] = {\r\n            price,\r\n            name,\r\n          };\r\n        }\r\n      });\r\n    });\r\n\r\n    return transporterVariations;\r\n  }\r\n\r\n  getDeliveryTypes() {\r\n    const transporterVariations = this.getTransporterVariations(\r\n      this.logisticsInfo\r\n    );\r\n\r\n    delete this.transporterSelected.deliveryType;\r\n    delete this.transporterSelected.deliveryTypes;\r\n\r\n    this.logisticsInfo[0].slas.forEach(({ id, name, deliveryIds }) => {\r\n      const key = id.toLowerCase().replace(/\\s/g, '');\r\n      const [courierName, courierType] = id.split(' - ');\r\n\r\n      const { courierId } = deliveryIds[0];\r\n\r\n      const { price } = transporterVariations[key];\r\n\r\n      const priceFormatted = this.helper.formatPrice(price);\r\n\r\n      const courier = [\r\n        {\r\n          price,\r\n          priceFormatted,\r\n          id: courierId,\r\n          type: courierType,\r\n          slaName: name,\r\n        },\r\n      ];\r\n\r\n      if (this.transporterSelected.deliveryTypes) {\r\n        this.transporterSelected.deliveryTypes = [\r\n          ...courier,\r\n          ...this.transporterSelected.deliveryTypes,\r\n        ];\r\n      } else {\r\n        this.transporterSelected.deliveryTypes = courier;\r\n      }\r\n    });\r\n  }\r\n\r\n  createProduct({\r\n    skuId,\r\n    imageUrl,\r\n    quantity,\r\n    productId,\r\n    productName,\r\n    description,\r\n    skuIdWithBox,\r\n    skuIdWithoutBox,\r\n    requiresLifting,\r\n    specialPackaging,\r\n    liftingQuantityOrigin,\r\n    liftingQuantityDestination,\r\n  }) {\r\n    return `\r\n      <article \r\n        class=\"product\"\r\n        data-product-id=\"${productId}\"\r\n        data-product-quantity=\"${quantity}\" \r\n        data-product-special-packaging=\"${specialPackaging}\"\r\n        data-sku-id-with-box=\"${skuIdWithBox || false}\"\r\n        data-sku-id-without-box=\"${skuIdWithoutBox}\"\r\n      >\r\n        <div class=\"product__container\">\r\n          <div class=\"product__container-checkbox\">\r\n            <label for=\"product-${productId}\">\r\n              <div class=\"checkbox\">\r\n                <input \r\n                  checked=\"true\"\r\n                  type=\"checkbox\"\r\n                  class=\"js-input-product-active\" \r\n                  id=\"product-${productId}\"\r\n                />\r\n                <i class=\"far fa-check checkbox__icon\"></i>\r\n              </div>\r\n            </label>\r\n          </div>\r\n      \r\n          <figure class=\"product__figure\">\r\n            <img \r\n              class=\"product__image\" \r\n              alt=\"${productName}\"\r\n              src=\"${imageUrl}\" \r\n            />\r\n          </figure>\r\n      \r\n          <div class=\"product__group\">\r\n            <h3 class=\"product__name\">${productName}</h3>\r\n          </div>\r\n        </div>\r\n        \r\n        <div class=\"product__actions\">\r\n          <button class=\"actions__button product__quantity--minus\">\r\n            <i class=\"fal fa-minus button__icon\"></i>\r\n          </button>\r\n      \r\n          <input\r\n            min=\"1\"\r\n            type=\"number\"\r\n            class=\"product__quantity\"\r\n            placeholder=\"1\"\r\n            value=\"${quantity}\"\r\n          />\r\n      \r\n          <button class=\"actions__button product__quantity--add\">\r\n            <i class=\"fal fa-plus button__icon\"></i>\r\n          </button>\r\n        </div>\r\n        \r\n        <button class=\"product__remove-button\">\r\n          <i class=\"far fa-trash-alt remove-button__icon\"></i>\r\n        </button>\r\n      </article>\r\n    `;\r\n  }\r\n\r\n  createCustomProduct(productData) {\r\n    const {\r\n      quantity,\r\n      customAttributes,\r\n      productId,\r\n      specialPackaging,\r\n    } = productData;\r\n\r\n    const customProduct = `\r\n      <article \r\n        class=\"product\"\r\n        data-product-id=\"${productId}\"\r\n        data-product-quantity=\"${quantity}\"\r\n        data-product-special-packaging=\"${specialPackaging}\"\r\n        data-sku-id-with-box=\"${26}\"\r\n        data-sku-id-without-box=\"${25}\"\r\n      >\r\n        <div class=\"product__container\">\r\n          <div class=\"product__container-checkbox\">\r\n            <label for=\"product-${productId}\">\r\n              <div class=\"checkbox\">\r\n                <input \r\n                  checked=\"true\" \r\n                  type=\"checkbox\"\r\n                  class=\"js-input-product-active\"\r\n                  id=\"product-${productId}\"\r\n                />\r\n                <i class=\"far fa-check checkbox__icon\"></i>\r\n              </div>\r\n            </label>\r\n          </div>\r\n\r\n          <div class=\"product__icon-container\">\r\n            <i class=\"far fa-box product__icon\"></i>\r\n          </div>\r\n          \r\n          <div class=\"product__group\">\r\n            <h3 class=\"product__name\">\r\n              ${customAttributes['product-name']}\r\n            </h3>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"product__actions\">\r\n          <button class=\"actions__button product__quantity--minus\">\r\n            <i class=\"fal fa-minus button__icon\"></i>\r\n          </button>\r\n      \r\n          <input\r\n            min=\"1\"\r\n            type=\"number\"\r\n            class=\"product__quantity\"\r\n            placeholder=\"1\"\r\n            value=\"${quantity}\"\r\n          />\r\n      \r\n          <button class=\"actions__button product__quantity--add\">\r\n            <i class=\"fal fa-plus button__icon\"></i>\r\n          </button>\r\n        </div>\r\n\r\n        <button class=\"product__remove-button\">\r\n          <i class=\"far fa-trash-alt remove-button__icon\"></i>\r\n        </button\r\n      </article>\r\n    `;\r\n\r\n    return customProduct;\r\n  }\r\n\r\n  createProductstInOrderForm() {\r\n    const { items: products } = this.orderForm;\r\n\r\n    const productsElementsArray = products\r\n      .filter(({ id }) => !SKUS_TO_IGNORE.includes(parseInt(id)))\r\n      .map(({ name, skuName, imageUrl, productId, quantity, id: skuId }) => {\r\n        const description = '';\r\n\r\n        const productName = name.replace(skuName, '');\r\n\r\n        const {\r\n          skuIdWithBox,\r\n          skuIdWithoutBox,\r\n          specialPackaging,\r\n          requiresLifting,\r\n          liftingQuantityOrigin,\r\n          liftingQuantityDestination,\r\n        } = this.products[productId];\r\n\r\n        return `\r\n            <div class=\"table__row\">\r\n              ${this.createProduct({\r\n                skuId,\r\n                quantity,\r\n                imageUrl,\r\n                productId,\r\n                productName,\r\n                description,\r\n                skuIdWithBox,\r\n                skuIdWithoutBox,\r\n                requiresLifting,\r\n                specialPackaging,\r\n                liftingQuantityOrigin,\r\n                liftingQuantityDestination,\r\n              })}\r\n            </div>\r\n          `;\r\n      });\r\n\r\n    const productsElementsHTML = productsElementsArray.join('');\r\n\r\n    return productsElementsHTML;\r\n  }\r\n\r\n  async getProductByID(productId) {\r\n    return await this.httpClient.get(\r\n      `/api/catalog_system/pub/products/variations/${productId}`\r\n    );\r\n  }\r\n\r\n  createCustomProducts() {\r\n    const customProducts = Object.values(this.products).filter(\r\n      ({ isCustom }) => isCustom\r\n    );\r\n\r\n    const customProductsHTML = customProducts\r\n      .map(productData => {\r\n        return `\r\n          <div class=\"table__row\">\r\n            ${this.createCustomProduct(productData)}\r\n          </div>\r\n        `;\r\n      })\r\n      .join('');\r\n\r\n    return customProductsHTML;\r\n  }\r\n\r\n  addCustomProductsToDOM(customProductsHTML) {\r\n    this.tableContentElement.innerHTML += customProductsHTML;\r\n  }\r\n\r\n  addOrderFormProductsToDOM(orderFormProductsHTML) {\r\n    this.tableContentElement.innerHTML += orderFormProductsHTML;\r\n  }\r\n\r\n  addTransporterToDOM(transporterHTML) {\r\n    const cardTransporter = document.querySelector('.card--transporter');\r\n\r\n    cardTransporter.innerHTML += transporterHTML;\r\n  }\r\n\r\n  getProductsInCustomData() {\r\n    try {\r\n      const { customData } = this.orderForm;\r\n\r\n      if (!customData) return;\r\n\r\n      customData.customApps\r\n        .filter(customApp => customApp.id === 'selecteditems')\r\n        .forEach(customApp => {\r\n          const { products_data } = customApp.fields;\r\n\r\n          const products = JSON.parse(products_data);\r\n\r\n          products.forEach(product => {\r\n            product.active = true;\r\n\r\n            this.products[product.productId] = product;\r\n          });\r\n        });\r\n    } catch (error) {\r\n      console.error('Error in getCustomProductsInLocalStorage', error);\r\n    }\r\n  }\r\n\r\n  createTransporterPriceElement(item, isSelected = false) {\r\n    return `\r\n      <div \r\n        class=\"price ${isSelected ? 'price--active' : ''}\" \r\n        data-transporter-delivery-type=\"${item.type}\"\r\n      >\r\n        <div class=\"price__row\">\r\n          <div class=\"price__container price__container--flex\">\r\n            <label for=\"${item.id}\">\r\n              <div class=\"checkbox\">\r\n                <input \r\n                  type=\"checkbox\" \r\n                  id=\"${item.id}\"\r\n                  ${isSelected ? 'checked=\"true\"' : ''}\r\n                />\r\n                  \r\n                <i class=\"fa fa-check checkbox__icon\"></i>\r\n              </div>\r\n\r\n              <p class=\"checkbox__label\">${item.type}</p>\r\n            </label>\r\n\r\n            <button \r\n              class=\"tooltip without-padding\" \r\n              data-balloon-pos=\"left\" \r\n              data-balloon-length=\"large\"\r\n              aria-label=\"${\r\n                item.type === 'Exclusivo'\r\n                  ? 'Nas mudanas exclusivas, o caminho da mudana vai direto para sua nova residncia. Apenas seus bens vo no caminho de mudana. Prazo de entrega: A entrega ocorrer imediatamente aps a embalagem dos seus itens. Por favor, considere os dias de viagens necessrios para que o caminho da mudana chegue at o destino. Antes da embalagem nossos consultores entraro em contato para agendar a melhor data para sua convenincia'\r\n                  : 'Nas mudanas compartilhadas os seus bens podem ir no caminho de mudana junto com outros de outras pessoas. Mas o fato de compartilhar o caminho no representa qualquer risco para seus bens e sem qualquer perda de qualidade. Prazo de entrega: Em at 45 dias da data da embalagem. Nossos consultores entraro em contato para agendar a melhor data para sua convenincia'\r\n              }\">\r\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M0 8C0 3.58172 3.58172 0 8 0C10.1217 0 12.1566 0.842855 13.6569 2.34315C15.1571 3.84344 16 5.87827 16 8C16 12.4183 12.4183 16 8 16C3.58172 16 0 12.4183 0 8ZM1.6 8C1.6 4.46538 4.46538 1.6 8 1.6C9.69739 1.6 11.3253 2.27428 12.5255 3.47452C13.7257 4.67475 14.4 6.30261 14.4 8C14.4 11.5346 11.5346 14.4 8 14.4C4.46538 14.4 1.6 11.5346 1.6 8Z\" fill=\"#FF8B30\"></path>\r\n                <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M10.2907 7.53114C10.5738 7.28895 10.7798 6.97699 10.8854 6.63034C11.0329 6.11191 10.9471 5.55896 10.6482 5.10234C10.4031 4.73488 10.0414 4.44987 9.61467 4.28794C9.11078 4.09022 8.5693 3.9922 8.02371 3.99994C7.65121 4.00747 7.28303 4.0768 6.93596 4.20474C6.41622 4.38232 5.96755 4.70764 5.65166 5.13594C5.46403 5.38958 5.36133 5.69056 5.35685 5.99994C5.3473 6.17964 5.42014 6.35453 5.55678 6.47994C5.6583 6.56944 5.78567 6.62846 5.92275 6.64954C6.23437 6.73113 6.56596 6.61184 6.74111 6.35514C6.81762 6.2391 6.88223 6.11632 6.94689 5.99346C6.97673 5.93675 7.00658 5.88002 7.03761 5.82394C7.15101 5.57642 7.36828 5.38457 7.6374 5.29434C7.88275 5.22353 8.14259 5.20981 8.39476 5.25434C8.55994 5.27946 8.71693 5.33964 8.85392 5.43034C9.23345 5.68314 9.30291 6.25434 9.08096 6.60314C8.91857 6.83449 8.71373 7.03659 8.47609 7.19994C8.15735 7.41611 7.85915 7.65809 7.58488 7.92314C7.34888 8.15468 7.21292 8.46108 7.20366 8.78234C7.18548 9.04698 7.32284 9.29964 7.56116 9.43994C7.7043 9.52066 7.87169 9.55441 8.03726 9.53594C8.29383 9.53636 8.52418 9.38752 8.61672 9.16154C8.66077 9.0634 8.70595 8.961 8.75226 8.85434C8.80661 8.71112 8.89875 8.58336 9.01996 8.48314L9.02 8.48311C9.20128 8.34872 9.38256 8.21433 9.56723 8.08634C9.82276 7.91863 10.0646 7.73304 10.2907 7.53114ZM7.01389 11.1343C7.01389 11.6124 7.42428 11.9999 7.93052 11.9999C8.17362 11.9999 8.40677 11.9087 8.57867 11.7464C8.75057 11.5841 8.84714 11.3639 8.84714 11.1343C8.84714 10.6563 8.43676 10.2687 7.93052 10.2687C7.42428 10.2687 7.01389 10.6563 7.01389 11.1343Z\" fill=\"#FF8B30\"></path>\r\n              </svg>\r\n            </button>\r\n          </div>\r\n\r\n          <div class=\"price__container price__container--right\">\r\n            <span class=\"price__total\">${item.priceFormatted}</span>\r\n            <p class=\"price__parcels\">at 6x sem juros</p>\r\n          </div>\r\n        </div>\r\n\r\n        ${\r\n          item.type === 'Compartilhado'\r\n            ? `\r\n          <p class=\"price__paragraph price__paragraph--text-orange price__paragraph--text-center price__paragraph--initial-wrap\">\r\n            * Prazo de entrega: em at 45 dias da data da embalagem.\r\n          </p>\r\n        `\r\n            : ''\r\n        }\r\n      </div> \r\n    `;\r\n  }\r\n\r\n  createTransporterElement(transporterData) {\r\n    const {\r\n      id,\r\n      nome,\r\n      logoURL,\r\n      features,\r\n      descricao,\r\n      deliveryTypes,\r\n      deliveryTypeSelected,\r\n    } = transporterData;\r\n\r\n    const prices = deliveryTypes\r\n      .map(item => {\r\n        const isSelected = item.id === deliveryTypeSelected.id;\r\n\r\n        return this.createTransporterPriceElement(item, isSelected);\r\n      })\r\n      .join('');\r\n\r\n    const deliveryShared = deliveryTypes.filter(\r\n      ({ type }) => type === 'Compartilhado'\r\n    )[0];\r\n\r\n    const deliveryExclusive = deliveryTypes.filter(\r\n      ({ type }) => type === 'Exclusivo'\r\n    )[0];\r\n\r\n    return `\r\n      <section \r\n        id=\"${id}\" \r\n        data-transporter-id=\"${id}\"\r\n        class=\"transporter transporter--without-padding\"\r\n        data-transporter-delivery-type-selected=\"${\r\n          deliveryShared ? deliveryShared.type : deliveryExclusive.type\r\n        }\"\r\n      >\r\n        <figure class=\"transporter__brand\">\r\n          <img \r\n            class=\"transporter__logo\" \r\n            src=\"${logoURL}\"\r\n          />\r\n        </figure>\r\n\r\n        <div class=\"transporter__details\">\r\n          <div class=\"transporter__row\">\r\n            <h3 class=\"transporter__name\">${nome}</h3>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"transporter__prices\">\r\n          ${prices}\r\n        </div>\r\n      </section>\r\n\r\n      <div class=\"shipping-date\" id=\"entenda-o-prazo-de-entrega-da-sua-mudanca\">\r\n        <p class=\"shipping-date__paragraph shipping-date__paragraph--center shipping-date__paragraph--margin-bottom\">\r\n          <b>Entenda o prazo de entrega da sua mudana</b>\r\n        </p>\r\n        \r\n        <p class=\"shipping-date__paragraph shipping-date__paragraph--margin-bottom\">\r\n          <b>COMPARTILHADA: </b> Em at 45 dias da data da embalagem. Nossos consultores entraro em contato para agendar a\r\n          melhor data para sua convenincia. Fique tranquilo, sua mudana no ser entregue sem prvio aviso.\r\n        </p>\r\n        \r\n        <p class=\"shipping-date__paragraph shipping-date__paragraph--margin-bottom\">\r\n          <b>EXCLUSIVA: </b> A entrega ocorrer imediatamente aps a embalagem dos seus itens. Por favor, considere os dias de\r\n          viagens necessrios para que o caminho da mudana chegue at o destino. Antes da embalagem nossos consultores\r\n          entraro em contato para agendar a melhor data para sua convenincia. Fique tranquilo, sua mudana no ser entregue\r\n          sem prvio aviso.\r\n        </p>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  setDate() {\r\n    const { customData } = this.orderForm;\r\n\r\n    if (!customData) return;\r\n\r\n    customData.customApps\r\n      .filter(customApp => customApp.id === 'orderinfo')\r\n      .forEach(customApp => {\r\n        const { moving_date } = customApp.fields;\r\n\r\n        this.dateSelected = moving_date;\r\n\r\n        this.updateCalendarComponent(moving_date);\r\n      });\r\n  }\r\n\r\n  updateCalendarComponent(movingData) {\r\n    const cardNumber = document.querySelector('.card__number--big');\r\n    const dateInstance = dayjs(new Date(movingData)).locale('pt-br');\r\n\r\n    const day = dateInstance.format('dddd');\r\n    const mounth = dateInstance.format('MMMM');\r\n    const year = dateInstance.year();\r\n\r\n    const dateFormatted = `${day}, ${mounth} / ${year}`;\r\n\r\n    cardNumber.textContent = dateInstance.date();\r\n    cardNumber.nextElementSibling.textContent = dateFormatted;\r\n  }\r\n\r\n  getAddress() {\r\n    const { customData } = this.orderForm;\r\n\r\n    if (!customData) return;\r\n\r\n    customData.customApps\r\n      .filter(customApp => customApp.id === 'orderinfo')\r\n      .forEach(customApp => {\r\n        const addressesFieldsArray = Object.entries(customApp.fields).filter(\r\n          ([key, value]) => {\r\n            return key.includes('from_') || key.includes('to_');\r\n          }\r\n        );\r\n\r\n        const addresses = addressesFieldsArray.reduce(\r\n          (obj, [key, value]) => ({ ...obj, [key]: value }),\r\n          {}\r\n        );\r\n\r\n        const addressFromContainer = document.querySelector('.js-address-from');\r\n        const addressToContainer = document.querySelector('.js-address-to');\r\n\r\n        [addressFromContainer, addressToContainer].forEach(container => {\r\n          const addressDirection = container.classList.contains(\r\n            'js-address-from'\r\n          )\r\n            ? 'from'\r\n            : 'to';\r\n\r\n          const cardContent = container.querySelector('.card__content');\r\n          const selectSpecialHandlyConditionSelected = container.querySelector(\r\n            '.js-address-special-handly-condition'\r\n          );\r\n          const selectHomeTypeSelected = container.querySelector(\r\n            '.js-address-home-type'\r\n          );\r\n\r\n          const specialHandlyCondition =\r\n            addresses[`${addressDirection}_special_handly_condition`];\r\n\r\n          const complement =\r\n            addresses[`${addressDirection}_address_complement`];\r\n          const county = addresses[`${addressDirection}_address_county`];\r\n          const streetName = addresses[`${addressDirection}_address_name`];\r\n          const number = addresses[`${addressDirection}_address_number`];\r\n          const zipcode = addresses[`${addressDirection}_address_zipcode`];\r\n          const city = addresses[`${addressDirection}_city`];\r\n          const state = addresses[`${addressDirection}_state`];\r\n          const homeType = addresses[`${addressDirection}_home_type`];\r\n\r\n          selectHomeTypeSelected.textContent = homeType;\r\n          selectSpecialHandlyConditionSelected.textContent = specialHandlyCondition;\r\n\r\n          const firstParagraphContent = [streetName, number]\r\n            .filter(item => item !== undefined && item !== '')\r\n            .join(', ');\r\n\r\n          const secondParagraphContent = [complement, county]\r\n            .filter(item => item !== undefined && item !== '')\r\n            .join(' - ');\r\n\r\n          const thirdParagraphContent = [city, state]\r\n            .filter(item => item !== undefined && item !== '')\r\n            .join(' - ');\r\n\r\n          cardContent.innerHTML = `\r\n            <h3 class=\"card__subtitle\">${zipcode}</h3>\r\n            <p class=\"card__paragraph\">${firstParagraphContent}</p>\r\n            <p class=\"card__paragraph\">${secondParagraphContent}</p>\r\n            <p class=\"card__paragraph\">${thirdParagraphContent}</p>\r\n          `;\r\n        });\r\n      });\r\n  }\r\n\r\n  getInsuranceItems() {\r\n    const { customData } = this.orderForm;\r\n\r\n    if (!customData) return;\r\n\r\n    customData.customApps\r\n      .filter(customApp => customApp.id === 'insurance')\r\n      .forEach(customApp => {\r\n        const { items } = customApp.fields;\r\n\r\n        if (['skipped', 'none'].includes(items)) return;\r\n\r\n        this.insuranceItems = JSON.parse(items);\r\n      });\r\n  }\r\n\r\n  async saveData(makeCRUD = true) {\r\n    try {\r\n      await window.vtexjs.checkout.removeAllItems();\r\n\r\n      const productsWithQuantity = Object.values(this.products).filter(\r\n        ({ quantity }) => quantity !== 0\r\n      );\r\n\r\n      const additionalWeightSKUs = this.getAdditionalWeightSKU(\r\n        productsWithQuantity\r\n      );\r\n\r\n      const products = productsWithQuantity.map(product => ({\r\n        ...product,\r\n        seller: 1,\r\n        id: product.skuId,\r\n      }));\r\n\r\n      const disassemblyAndAssemblySKUs = this.getDisassemblyAndAssemblySKU(\r\n        productsWithQuantity\r\n      );\r\n\r\n      const liftingSKUs = this.getLiftingSKUs();\r\n\r\n      const insuranceSKU = this.getInsuranceSKU();\r\n\r\n      const {\r\n        total: totalInsurancePrice,\r\n      } = this.getInsuranceDataInCustomData();\r\n\r\n      if (makeCRUD) {\r\n        if (totalInsurancePrice) {\r\n          await this.cartService.checkoutCRUD([\r\n            ...products,\r\n            ...liftingSKUs,\r\n            additionalWeightSKUs,\r\n            disassemblyAndAssemblySKUs,\r\n            insuranceSKU,\r\n          ]);\r\n        } else {\r\n          await this.cartService.checkoutCRUD([\r\n            ...products,\r\n            ...liftingSKUs,\r\n            additionalWeightSKUs,\r\n            disassemblyAndAssemblySKUs,\r\n          ]);\r\n        }\r\n      }\r\n\r\n      this.updateOrderForm(await this.cartService.getCurrent());\r\n\r\n      const insuranceSkuIndex = this.getInsuranceSkuIndex();\r\n\r\n      if (totalInsurancePrice && insuranceSkuIndex !== -1) {\r\n        this.updateOrderForm(\r\n          await this.insuranceService.updateInsuranceSKUPrice(\r\n            REAL(totalInsurancePrice).multiply(0.01).intValue,\r\n            insuranceSkuIndex,\r\n            this.orderForm.orderFormId\r\n          )\r\n        );\r\n      }\r\n\r\n      const liftingTotalPrice = this.calculateLiftingTotalPrice();\r\n      const totalForSpecialPackaging = this.calculateTotalForSpecialPackaging();\r\n      const totalDisassemblyAndAssemblyPrice = this.calculateTotalForDisassemblyAndAssembly();\r\n\r\n      this.updateServiceItem('Iamento', liftingTotalPrice);\r\n\r\n      this.updateServiceItem('Embalagem especial', totalForSpecialPackaging);\r\n\r\n      this.updateServiceItem(\r\n        'Desmontagem e Montagem',\r\n        totalDisassemblyAndAssemblyPrice\r\n      );\r\n\r\n      if (location.search.includes('logged')) {\r\n        this.updateOrderForm(\r\n          await this.cartService.updateCheckoutTransporterSLA(\r\n            this.logisticsInfo\r\n          )\r\n        );\r\n      }\r\n\r\n      const orderInfoFieldsForCustomData = {\r\n        current_step: 'order-summary',\r\n        moving_date: this.dateSelected,\r\n        user_selected_storage_months: this.userSelectedStorageMonths,\r\n        lifting_total_price: liftingTotalPrice,\r\n        special_packaging_total_price: totalForSpecialPackaging,\r\n        // \"storage_total_price\"\r\n        // storage_months: this.customSelectStorageServiceInstance.selectElement\r\n        // .selectedOptions[0].textContent,\r\n      };\r\n\r\n      const insuranceItemsForCustomData =\r\n        typeof this.insuranceItems === 'string'\r\n          ? this.insuranceItems\r\n          : JSON.stringify(this.insuranceItems);\r\n\r\n      const insuranceFieldsForCustomData = {\r\n        items: insuranceItemsForCustomData,\r\n        total: this.totalInsurance.format(),\r\n      };\r\n\r\n      // TODO: Uncomment this code when the storage feature is complete.\r\n      // await this.storageService.dispatchActionWorksWithStorageSKU(\r\n      //   this.userSelectedStorageMonths\r\n      // );\r\n\r\n      await Promise.all([\r\n        this.cartService.setMultipleCustomDataFields(\r\n          'orderinfo',\r\n          orderInfoFieldsForCustomData\r\n        ),\r\n        this.cartService.setMultipleCustomDataFields(\r\n          'insurance',\r\n          insuranceFieldsForCustomData\r\n        ),\r\n        this.cartService.setSingleCustomDataField(\r\n          'selecteditems',\r\n          'products_data',\r\n          JSON.stringify(productsWithQuantity)\r\n        ),\r\n        this.cartService.setSingleCustomDataField(\r\n          'selectedcourier',\r\n          'courier_data',\r\n          JSON.stringify(this.transporterSelected)\r\n        ),\r\n      ]);\r\n    } catch (error) {\r\n      console.log('saveData', error);\r\n    }\r\n  }\r\n\r\n  setHandledUpdateButtonClick() {\r\n    const buttonUpdate = document.querySelector('.js-button-update');\r\n    const buttonUpdateTextElement = buttonUpdate.querySelector('span');\r\n\r\n    buttonUpdate.addEventListener('click', e => {\r\n      const activeProducts = Object.values(this.products).filter(\r\n        product => product.active\r\n      );\r\n\r\n      if (activeProducts.length >= 1) {\r\n        this.hideUpdateErrorMessage();\r\n\r\n        this.handledUpdateButtonClick(buttonUpdate, buttonUpdateTextElement);\r\n      } else {\r\n        this.showUpdateErrorMessage();\r\n      }\r\n    });\r\n  }\r\n\r\n  showUpdateErrorMessage() {\r\n    const warningContainerElement = document.querySelector('.actions__warning');\r\n\r\n    warningContainerElement.classList.add('actions__warning--show');\r\n  }\r\n\r\n  hideUpdateErrorMessage() {\r\n    const warningContainerElement = document.querySelector('.actions__warning');\r\n\r\n    warningContainerElement.classList.remove('actions__warning--show');\r\n  }\r\n\r\n  async handledUpdateButtonClick(buttonUpdate, buttonUpdateTextElement) {\r\n    buttonUpdate.classList.add('js-loading');\r\n\r\n    await this.saveData();\r\n\r\n    this.updateInsuranceValue(true);\r\n\r\n    await this.updateTranspoterValue(true);\r\n\r\n    const isTransporterSelectedSimulated = Object.values(this.products)\r\n      .map(product => product.active)\r\n      .includes(false);\r\n\r\n    if (!isTransporterSelectedSimulated) {\r\n      await this.cartService.setSingleCustomDataField(\r\n        'selectedcourier',\r\n        'courier_data',\r\n        JSON.stringify(this.transporterSelected)\r\n      );\r\n    }\r\n\r\n    buttonUpdateTextElement.innerText = 'VALORES ATUALIZADOS';\r\n\r\n    this.updateTotalOrderValue();\r\n\r\n    buttonUpdate.classList.remove('js-loading');\r\n\r\n    setTimeout(() => {\r\n      buttonUpdateTextElement.innerText = 'ATUALIZAR VALORES';\r\n    }, 3000);\r\n  }\r\n\r\n  setAddressCep() {\r\n    const { customData } = this.orderForm;\r\n\r\n    if (!customData) return;\r\n\r\n    customData.customApps\r\n      .filter(customApp => customApp.id === 'orderinfo')\r\n      .forEach(customApp => {\r\n        const { to_address_zipcode } = customApp.fields;\r\n\r\n        this.addressCep = to_address_zipcode;\r\n      });\r\n  }\r\n\r\n  setHandledButtonSaveClick() {\r\n    const buttonSave = document.querySelector('.js-button-save');\r\n\r\n    buttonSave.addEventListener('click', async () => {\r\n      document.dispatchEvent(window.initSaveCustomDataEvent);\r\n\r\n      await this.saveData();\r\n\r\n      document.dispatchEvent(window.endSaveCustomDataEvent);\r\n    });\r\n  }\r\n\r\n  orderDeliveryTypesByLessPrice() {\r\n    this.transporterSelected.deliveryTypes.sort((a, b) => a.price - b.price);\r\n  }\r\n\r\n  getLiftingItems() {\r\n    const { items } = this.orderForm;\r\n\r\n    return items.filter(item => parseInt(item.productId) === 10);\r\n  }\r\n\r\n  calculateLiftingTotalPrice() {\r\n    let totalLiftingPrice;\r\n    const liftingItems = this.getLiftingItems();\r\n\r\n    if (liftingItems.length === 0) {\r\n      totalLiftingPrice = 0;\r\n    } else {\r\n      const liftingQuantityToSubtract = Object.values(this.products)\r\n        .filter(product => !product.active)\r\n        .reduce((total, product) => {\r\n          const newTotal = total + product.liftingQuantity;\r\n\r\n          return this.lifting === 'iamento na origem e destino'\r\n            ? newTotal * 2\r\n            : newTotal;\r\n        }, 0);\r\n\r\n      const liftingQuantity = liftingItems.reduce(\r\n        (total, item) => total + item.quantity,\r\n        -liftingQuantityToSubtract\r\n      );\r\n\r\n      const liftingPrice = liftingItems[0].price;\r\n      const firstLifting = liftingPrice;\r\n\r\n      totalLiftingPrice = ((liftingQuantity - 1) * liftingPrice) / 2;\r\n      totalLiftingPrice +=\r\n        liftingQuantity > 0 ? firstLifting : totalLiftingPrice * -1;\r\n\r\n      totalLiftingPrice = this.helper.formatPrice(totalLiftingPrice);\r\n    }\r\n\r\n    return REAL(totalLiftingPrice).format();\r\n  }\r\n\r\n  getStorageItem() {\r\n    const { items } = this.orderForm;\r\n\r\n    return items.filter(item => parseInt(item.productId) === 15)[0];\r\n  }\r\n\r\n  calculateStoragePrice() {\r\n    const storageItem = this.getStorageItem();\r\n\r\n    if (!storageItem) return 'R$ 0,00';\r\n\r\n    const totalStoragePrice = this.helper.formatPrice(\r\n      storageItem.price * storageItem.quantity\r\n    );\r\n\r\n    this.totalStorageMonth = REAL(totalStoragePrice)\r\n      .divide(parseInt(this.userSelectedStorageMonths))\r\n      .format();\r\n\r\n    return this.totalStorageMonth;\r\n  }\r\n\r\n  getItemsWithSpecialPackaging() {\r\n    const { items } = this.orderForm;\r\n\r\n    return items.filter(item => item.skuName === 'com caixa');\r\n  }\r\n\r\n  calculateTotalForSpecialPackaging() {\r\n    const itemsWithSpecialPackaging = this.getItemsWithSpecialPackaging();\r\n\r\n    const products = Object.values(this.products);\r\n\r\n    let totalSpecialPackagingPrice = itemsWithSpecialPackaging\r\n      .filter(({ productId, id }) => {\r\n        if (productId == 12) {\r\n          productId = products.filter(({ skuId }) => skuId == id)[0].productId;\r\n        }\r\n\r\n        return this.products[productId].active;\r\n      })\r\n      .reduce((total, item) => total + item.price * item.quantity, 0);\r\n\r\n    totalSpecialPackagingPrice = this.helper.formatPrice(\r\n      totalSpecialPackagingPrice\r\n    );\r\n\r\n    return REAL(totalSpecialPackagingPrice).format();\r\n  }\r\n\r\n  calculateTotalForDisassemblyAndAssembly() {\r\n    const { items } = this.orderForm;\r\n\r\n    const disassemblyAndAssemblySKU = items.find(\r\n      item => parseInt(item.id) === 699\r\n    );\r\n\r\n    if (!disassemblyAndAssemblySKU) return 'R$ 0,00';\r\n\r\n    const { quantity, price } = disassemblyAndAssemblySKU;\r\n\r\n    const totalSpecialPackagingPrice = this.helper.formatPrice(\r\n      quantity * price\r\n    );\r\n\r\n    return totalSpecialPackagingPrice;\r\n  }\r\n\r\n  createServiceItem(serviceName, serviceValue) {\r\n    return `\r\n      <div class=\"service\" data-service=\"${serviceName}\">\r\n        <div class=\"service__container\">\r\n          <div class=\"service__group\">\r\n            <h3 class=\"service__name\">${serviceName}</h3>\r\n          </div>\r\n        </div>\r\n\r\n        ${\r\n          serviceName === 'Armazenagem'\r\n            ? `\r\n          <div class=\"custom-select\">\r\n            <select class=\"select__native\">\r\n              <option value=\"1\">30 dias</option>\r\n              <option value=\"2\">60 dias</option>\r\n              <option value=\"3\">90 dias</option>\r\n              <option value=\"4\">120 dias</option>\r\n              <option value=\"5\">150 dias</option>\r\n              <option value=\"6\">180 dias</option>\r\n            </select>\r\n            \r\n            <span class=\"select__custom-selected\">30 dias</span>\r\n            \r\n            <div class=\"select__custom\">\r\n              <ul class=\"select__list\"></ul>\r\n            </div>\r\n\r\n            <i class=\"fas fa-caret-down select__icon\"></i>\r\n          </div>\r\n        `\r\n            : ''\r\n        }\r\n\r\n        <span class=\"service__value\">${serviceValue}</span>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  updateServiceItem(serviceID, serviceValue) {\r\n    const serviceItem = document.querySelector(\r\n      `.service[data-service=\"${serviceID}\"]`\r\n    );\r\n\r\n    if (serviceItem) {\r\n      const serviceItemValue = serviceItem.querySelector('.service__value');\r\n\r\n      serviceItemValue.textContent = serviceValue;\r\n    }\r\n  }\r\n\r\n  addServicesToDOM() {\r\n    const totalLiftingPrice = this.calculateLiftingTotalPrice();\r\n    const totalStoragePrice = this.calculateStoragePrice();\r\n    const totalSpecialPackagingPrice = this.calculateTotalForSpecialPackaging();\r\n    const totalDisassemblyAndAssemblyPrice = this.calculateTotalForDisassemblyAndAssembly();\r\n\r\n    const serviceStorageHTML =\r\n      totalStoragePrice !== 'R$ 0,00'\r\n        ? this.createServiceItem('Armazenagem', totalStoragePrice)\r\n        : '';\r\n\r\n    const serviceLiftingHTML =\r\n      totalLiftingPrice !== 'R$ 0,00'\r\n        ? this.createServiceItem('Iamento', totalLiftingPrice)\r\n        : '';\r\n\r\n    const serviceSpecialPackagingHTML =\r\n      totalSpecialPackagingPrice !== 'R$ 0,00'\r\n        ? this.createServiceItem(\r\n            'Embalagem especial',\r\n            totalSpecialPackagingPrice\r\n          )\r\n        : '';\r\n\r\n    const serviceDisassemblyAndAssemblyHTML =\r\n      totalDisassemblyAndAssemblyPrice !== 'R$ 0,00'\r\n        ? this.createServiceItem(\r\n            'Desmontagem e Montagem',\r\n            totalDisassemblyAndAssemblyPrice\r\n          )\r\n        : '';\r\n\r\n    const serviceItemsTable = document.querySelector('.service-items-table');\r\n\r\n    const elements = [\r\n      serviceStorageHTML,\r\n      serviceLiftingHTML,\r\n      serviceSpecialPackagingHTML,\r\n      serviceDisassemblyAndAssemblyHTML,\r\n    ].join('');\r\n\r\n    serviceItemsTable.innerHTML += elements;\r\n\r\n    if (serviceStorageHTML !== '') {\r\n      this.createCustomSelectForStorageService();\r\n      this.updateCustomSelectStorageService();\r\n    }\r\n\r\n    if (elements === '') {\r\n      serviceItemsTable.remove();\r\n    }\r\n  }\r\n\r\n  createCustomSelectForStorageService() {\r\n    const selectElement = document.querySelector(\r\n      '.custom-select .select__native'\r\n    );\r\n    const selectCustom = document.querySelector(\r\n      '.custom-select .select__custom'\r\n    );\r\n    const customSelectList = document.querySelector(\r\n      '.custom-select .select__list'\r\n    );\r\n    const customSelectSelected = document.querySelector(\r\n      '.custom-select .select__custom-selected'\r\n    );\r\n\r\n    this.customSelectStorageServiceInstance = new CustomSelect({\r\n      selectElement,\r\n      customSelectList,\r\n      customSelectSelected,\r\n      customSelectListItemClassName: '',\r\n      customSelectListItemClassNameActive: 'active',\r\n      selectOpenCallback: event => {\r\n        const selectListHeight = customSelectList.offsetHeight;\r\n\r\n        selectCustom.classList.add('select__custom--open');\r\n        selectCustom.style.maxHeight = `${selectListHeight}px`;\r\n      },\r\n      selectCloseCallback: () => {\r\n        selectCustom.classList.remove('select__custom--open');\r\n        selectCustom.style.maxHeight = 0;\r\n      },\r\n      selectChangeCallback: ({ value }) => {\r\n        this.totalStorage = REAL(this.totalStorageMonth).multiply(\r\n          parseInt(value)\r\n        );\r\n\r\n        this.userSelectedStorageMonths = parseInt(value);\r\n\r\n        this.updateServiceItem('Armazenagem', this.totalStorage.format());\r\n      },\r\n    });\r\n  }\r\n\r\n  getStorageMonths() {\r\n    const { customData } = this.orderForm;\r\n\r\n    if (!customData) return;\r\n\r\n    customData.customApps\r\n      .filter(customApp => customApp.id === 'orderinfo')\r\n      .forEach(({ fields }) => {\r\n        const { user_selected_storage_months } = fields;\r\n\r\n        if (user_selected_storage_months) {\r\n          this.userSelectedStorageMonths = user_selected_storage_months;\r\n        }\r\n      });\r\n  }\r\n\r\n  updateCustomSelectStorageService() {\r\n    this.customSelectStorageServiceInstance.changeOption(\r\n      this.userSelectedStorageMonths\r\n    );\r\n  }\r\n\r\n  updateSelectedSLA() {\r\n    const { slaName } = this.transporterSelected.deliveryTypeSelected;\r\n\r\n    this.logisticsInfo = this.logisticsInfo.map(item => ({\r\n      ...item,\r\n      selectedSla: slaName,\r\n    }));\r\n  }\r\n\r\n  getLiftingSKUs() {\r\n    this.getLiftingQuantity();\r\n\r\n    let liftingQuantity =\r\n      this.lifting === 'iamento na origem e destino'\r\n        ? this.liftingQuantity / 2\r\n        : this.liftingQuantity;\r\n\r\n    const skus = [];\r\n\r\n    if (\r\n      this.lifting === 'iamento na origem e destino' ||\r\n      this.lifting === 'iamento no origem'\r\n    ) {\r\n      liftingQuantity = Object.values(this.products)\r\n        .filter(({ quantity }) => quantity > 0)\r\n        .reduce((quantity, product) => {\r\n          return quantity + product.liftingQuantityOrigin;\r\n        }, 0);\r\n\r\n      skus.push({\r\n        id: 19,\r\n        skuId: 19,\r\n        seller: 1,\r\n        productId: 10,\r\n        quantity: liftingQuantity,\r\n      });\r\n    }\r\n\r\n    if (\r\n      this.lifting === 'iamento na origem e destino' ||\r\n      this.lifting === 'iamento no destino'\r\n    ) {\r\n      liftingQuantity = Object.values(this.products)\r\n        .filter(({ quantity }) => quantity > 0)\r\n        .reduce((quantity, product) => {\r\n          return quantity + product.liftingQuantityDestination;\r\n        }, 0);\r\n\r\n      skus.push({\r\n        id: 698,\r\n        skuId: 698,\r\n        seller: 1,\r\n        productId: 10,\r\n        quantity: liftingQuantity,\r\n      });\r\n    }\r\n\r\n    return skus;\r\n  }\r\n\r\n  getLiftingQuantity() {\r\n    this.liftingQuantity = Object.values(this.products)\r\n      .filter(({ quantity }) => quantity > 0)\r\n      .reduce((quantity, product) => {\r\n        return quantity + product.liftingQuantity;\r\n      }, 0);\r\n\r\n    this.liftingQuantity *=\r\n      this.lifting === 'iamento na origem e destino' ? 2 : 1;\r\n  }\r\n\r\n  removePageLoading() {\r\n    document.body.classList.remove('page-app--loading');\r\n  }\r\n\r\n  getAdditionalWeightSKU(products) {\r\n    const totalQuantity = products\r\n      .filter(product => product.additionalWeight)\r\n      .reduce((total, { quantity }) => total + quantity, 0);\r\n\r\n    return {\r\n      id: 696,\r\n      seller: 1,\r\n      quantity: totalQuantity,\r\n    };\r\n  }\r\n\r\n  getDisassemblyAndAssemblySKU(products) {\r\n    const totalQuantity = products\r\n      .filter(\r\n        ({ requiresAssembly, requiresDisassembly }) =>\r\n          requiresAssembly && requiresDisassembly\r\n      )\r\n      .reduce((total, { quantity }) => total + quantity, 0);\r\n\r\n    return {\r\n      id: 699,\r\n      seller: 1,\r\n      quantity: totalQuantity,\r\n    };\r\n  }\r\n\r\n  getInsuranceSKU() {\r\n    return {\r\n      id: 35,\r\n      seller: 1,\r\n      quantity: 1,\r\n    };\r\n  }\r\n\r\n  getInsuranceDataInCustomData() {\r\n    const { customData } = this.orderForm;\r\n\r\n    if (!customData) return {};\r\n\r\n    const insuranceApp = customData.customApps.find(\r\n      customApp => customApp.id === 'insurance'\r\n    );\r\n\r\n    if (!insuranceApp) return {};\r\n\r\n    return insuranceApp.fields;\r\n  }\r\n\r\n  getInsuranceSkuIndex() {\r\n    const { items } = this.orderForm;\r\n\r\n    const insuranceSkudId = 35;\r\n\r\n    const itemIndex = items.findIndex(\r\n      item => parseInt(item.id) === insuranceSkudId\r\n    );\r\n\r\n    return itemIndex;\r\n  }\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n  new OrderSummaryPage();\r\n});\r\n","import fetch from 'unfetch';\r\nimport { Ensure, Logger } from '../common';\r\n\r\n/**\r\n * HttpClient Abstraction class\r\n */\r\nclass HttpClient {\r\n  /**\r\n   * HttpClient constructor\r\n   */\r\n  constructor() {\r\n    this._logger = new Logger('httpClient');\r\n  }\r\n\r\n  /**\r\n   * Get\r\n   * @param {String} endpointUrl\r\n   * @return {Promise}\r\n   */\r\n  get(endpointUrl) {\r\n    if (!Ensure.isUndefined(endpointUrl)) {\r\n      return this._execute(endpointUrl, 'GET');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Delete\r\n   * @param {String} endpointUrl\r\n   * @return {Promise}\r\n   */\r\n  delete(endpointUrl) {\r\n    if (!Ensure.isUndefined(endpointUrl)) {\r\n      return this._execute(endpointUrl, 'DELETE');\r\n    }\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param {String} endpointUrl\r\n   * @param {JSON} payload\r\n   * @return {Promise}\r\n   */\r\n  post(endpointUrl, payload = {}) {\r\n    if (!Ensure.isUndefined(endpointUrl)) {\r\n      return this._execute(endpointUrl, 'POST', payload);\r\n    }\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param {String} endpointUrl\r\n   * @param {JSON} payload\r\n   * @return {Promise}\r\n   */\r\n  put(endpointUrl, payload) {\r\n    if (!Ensure.isUndefined(endpointUrl) && !Ensure.isUndefined(payload)) {\r\n      return this._execute(endpointUrl, 'PUT', payload);\r\n    }\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param {String} endpointUrl\r\n   * @param {JSON} payload\r\n   * @return {Promise}\r\n   */\r\n  patch(endpointUrl, payload) {\r\n    if (!Ensure.isUndefined(endpointUrl) && !Ensure.isUndefined(payload)) {\r\n      return this._execute(endpointUrl, 'PATCH', payload);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {String} endpointUrl\r\n   * @param {String} httpVerb\r\n   * @param {Object} payload\r\n   * @return {Promise}\r\n   */\r\n  _execute(endpointUrl, httpVerb, payload) {\r\n    let header = {\r\n      method: httpVerb,\r\n      headers: {\r\n        // 'Accept': 'application/vnd.vtex.ds.v10+json',\r\n        // 'Content-Type': 'application/json',\r\n        accept: 'application/vnd.vtex.masterdata.v10+json',\r\n        'content-type': 'application/json; charset=utf-8',\r\n      },\r\n    };\r\n\r\n    if (payload) {\r\n      header['body'] = JSON.stringify(payload);\r\n    }\r\n\r\n    return fetch(endpointUrl, header)\r\n      .then(this.validateResponse)\r\n      .then(this.parseResponseToJson)\r\n      .then(data => {\r\n        return data;\r\n      })\r\n      .catch(error => {\r\n        this._logger.log('Request succeeded with JSON response', error);\r\n        return error;\r\n      });\r\n  }\r\n\r\n  /**\r\n   * Parse response data to json object\r\n   * @param {*} response - Request response\r\n   * @return {JSON} json data\r\n   */\r\n  async parseResponseToJson(response) {\r\n    if (!response.ok) {\r\n      return response;\r\n    }\r\n\r\n    return await response.json();\r\n  }\r\n\r\n  /**\r\n   * Response validation\r\n   * @param {*} response\r\n   * @return {Promise} promise result\r\n   */\r\n  validateResponse(response) {\r\n    if (response.ok) {\r\n      return Promise.resolve(response);\r\n    } else {\r\n      return Promise.reject(new Error(response.statusText));\r\n    }\r\n  }\r\n}\r\n\r\nexport default HttpClient;\r\n"],"sourceRoot":""}