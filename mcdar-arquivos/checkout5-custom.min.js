/* DESKTOP-TKPPA5A - 20/04/2020 16:43:02 GMT */
(function(){"function"!==typeof $.cookie&&function(c){"function"===typeof define&&define.amd?define(["jquery"],c):"object"===typeof exports?c(require("jquery")):c(jQuery)}(function(c){function p(a){a=e.json?JSON.stringify(a):String(a);return e.raw?a:encodeURIComponent(a)}function n(a,g){var b;if(e.raw)b=a;else a:{var d=a;0===d.indexOf('"')&&(d=d.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{d=decodeURIComponent(d.replace(l," "));b=e.json?JSON.parse(d):d;break a}catch(h){}b=void 0}return c.isFunction(g)?g(b):b}var l=/\+/g,e=c.cookie=function(a,g,b){if(1<arguments.length&&!c.isFunction(g)){b=c.extend({},e.defaults,b);if("number"===typeof b.expires){var d=b.expires,h=b.expires=new Date;h.setTime(+h+864e5*d)}return document.cookie=[e.raw?a:encodeURIComponent(a),"=",p(g),b.expires?"; expires="+b.expires.toUTCString():"",b.path?"; path="+b.path:"",b.domain?"; domain="+b.domain:"",b.secure?"; secure":""].join("")}for(var d=a?void 0:{},h=document.cookie?document.cookie.split("; "):[],m=0,l=h.length;m<l;m++){var f=h[m].split("="),k;k=f.shift();k=e.raw?k:decodeURIComponent(k);f=f.join("=");if(a&&a===k){d=n(f,g);break}a||void 0===(f=n(f))||(d[k]=f)}return d};e.defaults={};c.removeCookie=function(a,e){if(void 0===c.cookie(a))return!1;c.cookie(a,"",c.extend({},e,{expires:-1}));return!c.cookie(a)}})})();(function(){var a,h,g;a=jQuery;g={cookieName:"Nome_Padrao",closeLimit:2,expireDays:365,completeExpireDays:365,path:"/",close:"[class*=close]",show:function(a){a.slideDown()},hide:function(a){a.slideUp()},callback:function(){},exceededLimitCallback:function(){},closeCallback:function(){}};var k=function(a,d){if("object"===typeof console){var e;"object"===typeof a?(a.unshift("[Cookie Functions]\n"),e=a):e=["[Cookie Functions]\n"+a];"undefined"===typeof d||"alerta"!==d.toLowerCase()&&"aviso"!==d.toLowerCase()?"undefined"!==typeof d&&"info"===d.toLowerCase()?console.info.apply(console,e):console.error.apply(console,e):console.warn.apply(console,e)}};a.QD_cookieFn=function(f){if("function"!==typeof a.cookie)return k("Aeeeee irmãããooooo!\nEsta faltando o plugin $.cookie mew. Chama ele na página, vlw!");var d=function(c,b){var d=a.cookie("qdCookieFn_"+b.cookieName);if("undefined"!==typeof d&&d>=b.closeLimit||a.cookie("qdCookieFn_"+b.cookieName+"_complete"))return b.exceededLimitCallback();b.show(c);c.trigger("QuatroDigital.cf_show");a(c).on("qdNewsSuccessCallback",function(a,d){c.trigger("QuatroDigital.qdcf_applyComplete");b.show(c);c.trigger("QuatroDigital.cf_hide")});b.callback();c.trigger("QuatroDigital.cf_callback")},e=function(a,b){a.find(b.close).not(".qd-cookie-on").addClass("qd-cookie-on").bind("click",function(){a.trigger("QuatroDigital.cf_close");a.slideUp(function(){b.closeCallback()})})},g=function(c,b){c.bind("QuatroDigital.cf_close",function(){"undefined"===typeof a.cookie("qdCookieFn_"+b.cookieName)?a.cookie("qdCookieFn_"+b.cookieName,1,{expires:b.expireDays,path:b.path}):a.cookie("qdCookieFn_"+b.cookieName,(parseInt(a.cookie("qdCookieFn_"+b.cookieName),10)||0)+1,{expires:b.expireDays,path:b.path})});c.bind("QuatroDigital.qdcf_applyComplete",function(){a.cookie("qdCookieFn_"+b.cookieName+"_complete",1,{expires:b.completeExpireDays,path:b.path})});c.bind("QuatroDigital.qdcf_applyLimit",function(){a.cookie("qdCookieFn_"+b.cookieName,b.closeLimit,{expires:b.expireDays,path:b.path})})};f.each(function(){var c=a(this),b;try{if(b=c.attr("data-qd-cookie"))var f=a.parseJSON("{"+b+"}")}catch(l){k(['Aeee irmãooo!\nNão consegui converter as suas opções do atributo [data-qd-cookie], verifique se você escreveu no formato esperado que é (respeitando-se todas as aspas simples e duplas):\n<div data-qd-cookie=\'"chave":"valor","chave2":"valor2"\' />.',"\n\nDetalhes do erro: "+l.message],"alerta"),f={}}b=a.extend({},h,f);g(c,b);d(c,b);e(c,b)})};a.fn.QD_cookieFn=function(f){var d=a(this);h=a.extend(!0,{},g,f);d.QD_cookieFn=new a.QD_cookieFn(d);return d};a(function(){a("[data-qd-cookie]").QD_cookieFn()})})();var MZCheckout={init:function(){MZCheckout.checkIfAddressExists();MZCheckout.getAddressFromSessionStorage();MZCheckout.setHeaderAddressText();MZCheckout.loginButton();MZCheckout.watchForAuthStatus();MZCheckout.setWebUTM();MZCheckout.applyFlowProgressBuy()},checkIfAddressExists:function(){if(!$.cookie("mzAddress")&&window.location.pathname!="/"){window.location.pathname="/"}},getAddressFromSessionStorage:function(){if($.cookie("mzFormattedAddress")){var mzFormattedAddress=decodeURIComponent($.cookie("mzFormattedAddress"));$(".address").html(mzFormattedAddress)}if($.cookie("mzAddress")&&$.cookie("mzClosest")){var closest=decodeURIComponent($.cookie("mzClosest"));MZCheckout.checkIfOpen(closest).done(function(data){if(!data.data.operational){$("body").addClass("no-working");$(".MZph__alert.adress-closed").fadeIn();$(".MZph__bgmodal").fadeIn();var startOp=data.data.operation.start;var endOp=data.data.operation.end;$(".a-c--hourwork span").text("O hórario de funcionamento "+startOp+"h às "+endOp+"h");$(".MZAddressChange").addClass("show-address-closed").removeClass("show-postal-code");console.log("Não está operacional esta loja: "+firstStore)}})}},setHeaderAddressText:function(){if($.cookie("mzAddress")){$(".MZa__address").find(".address").html(decodeURIComponent($.cookie("mzFormattedAddress")))}},checkIfOpen:function(store){return $.ajax({url:"/api/io/checking_hours/checking?restaurant="+store,type:"GET",dataType:"json",headers:{Accept:"application/vnd.vtex.ds.v10+json"}})},loginButton:function(){$("#btn-client-pre-email").on("click",function(e){e.preventDefault();var email=encodeURIComponent($(".client-email #client-pre-email").val());$.ajax({url:"/api/checkout/pub/profiles/?email="+email+"&sc=1"}).done(function(result){if(!result||!result.userProfileId){var address=JSON.parse(decodeURIComponent($.cookie("mzAddress")));MZCheckout.sendAddressToOrderForm(address);$("#btn-client-pre-email").submit()}else{var email=$("#client-pre-email").val();vtexid.start({userEmail:email,locale:"pt-BR",forceReload:false})}})})},sendAddressToOrderForm:function(address,refresh){address.addressType=address.addressType?address.addressType:"residential";address.number=$(".f-o--inputNumber").val()?$(".f-o--inputNumber").val():address.number;var complement=$(".f-o--inputComplement").val()?$(".f-o--inputComplement").val():"";address.complement=complement?complement:address.complement;address.geoCoordinatesIsValid=true;address.useGeolocationSearch=true;address.isPostalCodeValid=false;var sp={address:address};vtexjs.checkout.getOrderForm().done(function(orderf){if(!orderf.canEditData){MZCheckout.promptLoginWhenAuthenticated()}else{if(MZCheckout.checkForNeedOfUpdate(orderf)){vtexjs.checkout.sendAttachment("shippingData",sp).done(function(orderf){if(window.location.hash=="#/payment"||window.location.hash=="#/shipping"){console.log("hash of");setTimeout(function(){console.log("of");window.location.hash="#/orderform"},300)}})}}})},watchForAuthStatus:function(){var address=JSON.parse(decodeURIComponent($.cookie("mzAddress")));MZCheckout.sendAddressToOrderForm(address,true);$(window).on("hashchange",function(){if(window.location.hash=="#/payment"||window.location.hash=="#/shipping"){MZCheckout.sendAddressToOrderForm(address,true)}})},checkForNeedOfUpdate:function(orderForm){try{if(!orderForm||!orderForm.shippingData||!orderForm.shippingData.address){return true}var address=orderForm.shippingData.address;if(vtexjs&&vtexjs.checkout&&vtexjs.checkout.orderForm&&vtexjs.checkout.orderForm.shippingData&&(window.location.hash=="#/payment"||window.location.hash=="#/shipping")){var postalCode=address.postalCode.replace("-","");var street=address.street;var neighborhood=address.neighborhood;var cookieAddress=JSON.parse(decodeURIComponent($.cookie("mzAddress")));var number=address.number;if(cookieAddress.postalCode.replace("-","")!=postalCode||cookieAddress.neighborhood!=neighborhood||number!=cookieAddress.number){console.log("reload");return true}else{return false}}}catch(e){console.log("Algo deu errado:"+e.message);return true}},setWebUTM:function(){try{setTimeout(function(){if(!vtexjs.checkout.orderForm.marketingData||!vtexjs.checkout.orderForm.marketingData.utmSource||!vtexjs.checkout.orderForm.marketingData.utmSource=="WEB"){vtexjs.checkout.getOrderForm().then(function(orderForm){return vtexjs.checkout.sendAttachment("marketingData",{utmSource:"WEB"})}).done(function(orderForm){console.log(orderForm.utmSource)})}},2e3)}catch(e){console.error("Ocorreu um erro: "+e.message)}},applyFlowProgressBuy:function(){var imageFlow=$(".mz-flowbuy img");var pathFlow=["mz-fluxocompra1.png","mz-fluxocompra2.png","mz-fluxocompra3.png"];$(window).on("hashchange",function(e){if(window.location.hash=="#/profile"){imageFlow.attr("src","/arquivos/"+pathFlow[0]+"");$(".mz-flowbuy").show()}else if(window.location.hash=="#/shipping"){imageFlow.attr("src","/arquivos/"+pathFlow[1]+"");$(".mz-flowbuy").show()}else if(window.location.hash=="#/payment"){imageFlow.attr("src","/arquivos/"+pathFlow[2]+"");$(".mz-flowbuy").show()}else if(window.location.hash!="#/profile"||window.location.hash!="#/shipping"||window.location.hash!="#/payment"){$(".mz-flowbuy").hide()}})},promptLoginWhenAuthenticated:function(){if(vtexjs&&vtexjs.checkout&&vtexjs.checkout.orderForm&&!vtexjs.checkout.orderForm.canEditData&&(window.location.hash=="#/payment"||window.location.hash=="#/shipping")){vtexid.start({locale:"pt-BR",forceReload:false})}}};$(function(){MZCheckout.init()});